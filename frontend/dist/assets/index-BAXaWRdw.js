import{r as jt,a as wt,g as Nt}from"./vendor-DavUf6mE.js";import{u as ye,r as t,R as _e,a as Me,B as St,b as It,c as be}from"./router-Bv43RzvU.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))c(l);new MutationObserver(l=>{for(const y of l)if(y.type==="childList")for(const g of y.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&c(g)}).observe(document,{childList:!0,subtree:!0});function s(l){const y={};return l.integrity&&(y.integrity=l.integrity),l.referrerPolicy&&(y.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?y.credentials="include":l.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function c(l){if(l.ep)return;l.ep=!0;const y=s(l);fetch(l.href,y)}})();var Ae={exports:{}},Ie={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ve;function Ct(){if(Ve)return Ie;Ve=1;var a=jt(),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y={key:!0,ref:!0,__self:!0,__source:!0};function g(d,j,h){var x,w={},E=null,D=null;h!==void 0&&(E=""+h),j.key!==void 0&&(E=""+j.key),j.ref!==void 0&&(D=j.ref);for(x in j)c.call(j,x)&&!y.hasOwnProperty(x)&&(w[x]=j[x]);if(d&&d.defaultProps)for(x in j=d.defaultProps,j)w[x]===void 0&&(w[x]=j[x]);return{$$typeof:r,type:d,key:E,ref:D,props:w,_owner:l.current}}return Ie.Fragment=s,Ie.jsx=g,Ie.jsxs=g,Ie}var Ke;function kt(){return Ke||(Ke=1,Ae.exports=Ct()),Ae.exports}var e=kt(),Ee={},Ze;function Lt(){if(Ze)return Ee;Ze=1;var a=wt();return Ee.createRoot=a.createRoot,Ee.hydrateRoot=a.hydrateRoot,Ee}var Et=Lt();const Rt=Nt(Et);function pe(){return e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-24 left-8 md:top-32 md:left-16 w-12 h-12 md:w-20 md:h-20 rounded-full bg-[#7b7583] opacity-40"}),e.jsx("div",{className:"absolute top-20 right-8 md:top-28 md:right-16 w-6 h-6 md:w-10 md:h-10",children:e.jsxs("div",{className:"absolute inset-0 bg-white opacity-80",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 w-full h-0.5 bg-white transform -translate-x-1/2 -translate-y-1/2"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-0.5 h-full bg-white transform -translate-x-1/2 -translate-y-1/2"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-full h-0.5 bg-white transform -translate-x-1/2 -translate-y-1/2 rotate-45"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-full h-0.5 bg-white transform -translate-x-1/2 -translate-y-1/2 -rotate-45"})]})}),e.jsx("div",{className:"absolute top-64 right-6 md:top-80 md:right-12 w-4 h-4 md:w-6 md:h-6 bg-[#9351f7] transform rotate-45 opacity-80"}),e.jsx("div",{className:"absolute top-72 left-1/2 transform -translate-x-1/2 md:top-96 w-3 h-3 md:w-4 md:h-4 bg-[#e971ff] rotate-45 opacity-70"}),e.jsx("div",{className:"absolute top-80 left-8 md:top-96 md:left-16 w-6 h-6 md:w-10 md:h-10 rounded-full border-2 border-[#7b7583] opacity-50"}),e.jsx("div",{className:"absolute top-96 right-12 md:top-[28rem] md:right-20 w-2 h-2 md:w-3 md:h-3 bg-[#741ff5] transform rotate-45 opacity-60"})]})}function Pt(){return e.jsxs("header",{className:"flex justify-between items-center py-4 md:py-6 relative z-10",children:[e.jsx("div",{className:"text-white text-2xl md:text-3xl font-bold",children:"HBlast"}),e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12",children:e.jsx("img",{src:"/images/icon.png",alt:"HBlast Score Icon",className:"w-full h-full object-contain"})})]})}function zt(){return e.jsxs("div",{className:"max-w-4xl mb-6 md:mb-8 px-6 lg:px-8",children:[e.jsxs("h1",{className:"text-white text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-bold leading-tight md:leading-[0.9] mb-4 md:mb-6",children:[e.jsx("span",{className:"block",children:"Tag Smarter. Move"}),e.jsx("span",{className:"block",children:"Faster. Win."})]}),e.jsxs("p",{className:"text-[#b7b4bb] text-sm md:text-base lg:text-lg max-w-xs md:max-w-sm mx-auto leading-relaxed",children:["AI-driven hit detection means you",e.jsx("br",{className:"hidden sm:block"}),"focus on strategy, not setup."]})]})}function Mt(){return e.jsxs("div",{className:"relative mb-6 md:mb-8 w-full max-w-sm md:max-w-lg lg:max-w-xl px-4",children:[e.jsx("div",{className:"absolute left-2 md:left-6 lg:left-8 top-0 w-32 h-32 md:w-48 md:h-48 lg:w-56 lg:h-56 bg-gradient-to-br from-[#1a2332] to-[#0f1419] rounded-2xl md:rounded-3xl transform -rotate-12 shadow-xl overflow-hidden border border-[#2a3441]/30",children:e.jsx("img",{src:"/images/weapon.jpg",alt:"Futuristic weapon with glowing elements",className:"w-full h-full object-cover"})}),e.jsx("div",{className:"absolute right-2 md:right-6 lg:right-8 top-4 md:top-6 lg:top-8 w-32 h-32 md:w-48 md:h-48 lg:w-56 lg:h-56 bg-gradient-to-br from-[#1a2332] to-[#0f1419] rounded-2xl md:rounded-3xl transform rotate-12 shadow-xl overflow-hidden border border-[#2a3441]/30",children:e.jsx("img",{src:"/images/characters.jpg",alt:"Team of tactical players with futuristic weapons",className:"w-full h-full object-cover"})}),e.jsx("div",{className:"h-40 md:h-56 lg:h-64"})]})}function $t(){const a=[{src:"/images/avatar-01.png",alt:"Player 1 - Man with glasses and beard"},{src:"/images/avatar-07.png",alt:"Player 2 - Woman with braided hair"},{src:"/images/avatar-03.png",alt:"Player 3 - Person with glasses and curly hair"}];return e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 md:gap-6 mb-6 md:mb-8 px-4",children:[e.jsx("div",{className:"flex -space-x-3 md:-space-x-4",children:a.map((r,s)=>e.jsx("div",{className:"w-12 h-12 md:w-16 md:h-16 rounded-full border-3 md:border-4 border-white shadow-lg overflow-hidden",children:e.jsx("img",{src:r.src||"/placeholder.svg",alt:r.alt,className:"w-full h-full object-cover"})},s))}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("div",{className:"text-white text-3xl md:text-4xl font-bold",children:"4+"}),e.jsx("div",{className:"text-[#838383] text-xs md:text-sm",children:"session players"})]})]})}function Ot(){return e.jsx("div",{className:"mt-6 md:mt-8",children:e.jsx("svg",{width:"80",height:"16",viewBox:"0 0 80 16",fill:"none",className:"md:w-[120px] md:h-[24px]",children:e.jsx("path",{d:"M0 8L13 0L27 16L40 0L53 16L67 0L80 8",stroke:"#9351f7",strokeWidth:"2",fill:"none",className:"md:stroke-[3]"})})})}const Tt=()=>{const a=ye();return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0f051d] via-[#1f152b] to-[#0f051d] relative overflow-hidden",children:[e.jsx(pe,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 md:px-6 lg:px-8",children:[e.jsx(Pt,{}),e.jsxs("main",{className:"flex flex-col items-center text-center relative z-10 py-2 md:py-4",children:[e.jsx(zt,{}),e.jsx(Mt,{}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 md:gap-4 mb-6 md:mb-8 px-4 w-full max-w-xs sm:max-w-lg justify-center",children:[e.jsx("button",{onClick:()=>a("/lobby"),className:"bg-gradient-to-r from-[#6d28d9] to-[#8b5cf6] hover:from-[#7c3aed] hover:to-[#a855f7] text-white px-8 md:px-10 py-3 md:py-3.5 rounded-full text-sm md:text-base font-semibold shadow-lg flex-1 sm:min-w-[140px] md:min-w-[160px] transition-all duration-200",children:"Play Game"}),e.jsx("button",{onClick:()=>a("/spectate"),className:"bg-gradient-to-r from-[#8b5cf6] to-[#a855f7] hover:from-[#a855f7] hover:to-[#c084fc] text-white px-8 md:px-10 py-3 md:py-3.5 rounded-full text-sm md:text-base font-semibold shadow-lg flex-1 sm:min-w-[140px] md:min-w-[160px] transition-all duration-200",children:"Spectate Game"})]}),e.jsx($t,{}),e.jsx(Ot,{})]})]})]})},st=t.createContext(null);function he(){return t.useContext(st)}function At({children:a}){const[r,s]=t.useState("connecting"),c=t.useRef(null),[l,y]=t.useState(null);t.useEffect(()=>{let d;return d||(d="wss://csis3784-project-backend-1.onrender.com"),c.current=new window.WebSocket(d),c.current.onopen=()=>s("open"),c.current.onclose=()=>s("closed"),c.current.onerror=()=>s("error"),c.current.onmessage=j=>{console.log("WS received:",j.data),y(j.data);try{const h=JSON.parse(j.data);h.type==="welcome"&&h.userId&&localStorage.setItem("userId",h.userId)}catch{}},()=>{c.current&&c.current.readyState===WebSocket.OPEN&&c.current.close()}},[]);const g=d=>{c.current&&c.current.readyState===WebSocket.OPEN&&c.current.send(JSON.stringify(d))};return e.jsx(st.Provider,{value:{ws:c.current,wsStatus:r,lastMessage:l,sendMessage:g},children:a})}/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),at=(...a)=>a.filter((r,s,c)=>!!r&&c.indexOf(r)===s).join(" ");/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _t={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=t.forwardRef(({color:a="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:c,className:l="",children:y,iconNode:g,...d},j)=>t.createElement("svg",{ref:j,..._t,width:r,height:r,stroke:a,strokeWidth:c?Number(s)*24/Number(r):s,className:at("lucide",l),...d},[...g.map(([h,x])=>t.createElement(h,x)),...Array.isArray(y)?y:[y]]));/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=(a,r)=>{const s=t.forwardRef(({className:c,...l},y)=>t.createElement(Ft,{ref:y,iconNode:r,className:at(`lucide-${Dt(a)}`,c),...l}));return s.displayName=`${a}`,s};/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=A("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=A("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=A("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=A("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=A("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=A("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=A("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=A("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=A("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=A("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=A("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=A("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=A("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=A("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=A("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=A("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=A("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=A("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=A("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=A("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=A("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=A("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=A("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=A("Signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=A("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=A("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=A("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=A("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=A("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=A("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=A("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=A("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=A("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),ss=()=>{const a=ye(),{ws:r,sendMessage:s}=he(),[c,l]=t.useState({totalLobbies:0,totalPlayers:0,activeGames:0});return t.useEffect(()=>{if(!r)return;const y=g=>{try{const d=JSON.parse(g.data);if(d.type==="lobby_list"&&Array.isArray(d.lobbies)){const j=d.lobbies.length,h=d.lobbies.reduce((w,E)=>w+E.playerCount,0),x=d.lobbies.filter(w=>w.playerCount>1).length;l({totalLobbies:j,totalPlayers:h,activeGames:x})}}catch(d){console.error("Error parsing WebSocket message:",d)}};return r.addEventListener("message",y),s({type:"show_lobbies"}),()=>r.removeEventListener("message",y)},[r,s]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0f051d] via-[#1f152b] to-[#0f051d] relative overflow-hidden",children:[e.jsx(pe,{}),e.jsxs("header",{className:"flex justify-between items-center py-4 md:py-6 relative z-10 px-4 md:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>a("/"),className:"text-white hover:text-[#e971ff] transition-colors p-2 rounded-full hover:bg-white/10",children:e.jsx(Ne,{size:24})}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:"HBlast"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-[#b7b4bb] text-sm md:text-base",children:"Player Lobby"}),e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10",children:e.jsx("img",{src:"/images/icon.png",alt:"HBlast Score Icon",className:"w-full h-full object-contain"})})]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-120px)] px-4 md:px-6 lg:px-8 relative z-10",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsxs("h1",{className:"text-white text-3xl md:text-4xl lg:text-5xl font-bold mb-4",children:[e.jsx("span",{className:"block",children:"Ready to"}),e.jsx("span",{className:"block",children:"Join the Battle?"})]}),e.jsx("p",{className:"text-[#b7b4bb] text-base md:text-lg max-w-md mx-auto",children:"Create your own arena or jump into an existing match"})]}),e.jsxs("div",{className:"w-full max-w-md space-y-4 md:space-y-6 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-6 md:p-8 border-2 border-[#9351f7]/40 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-[1.02] hover:border-[#e971ff]/60 hover:shadow-[#9351f7]/20",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#741ff5] to-[#9351f7] p-3 rounded-full",children:e.jsx(Xt,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white text-xl font-bold",children:"Create New Lobby"}),e.jsx("p",{className:"text-[#b7b4bb] text-sm",children:"Start your own match"})]})]}),e.jsx("button",{onClick:()=>a("/lobby/create"),className:"w-full bg-gradient-to-r from-[#741ff5] to-[#9351f7] hover:from-[#9351f7] hover:to-[#e971ff] text-white px-6 py-3 rounded-full font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl",children:"Create a New Lobby"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-6 md:p-8 border-2 border-[#9351f7]/40 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-[1.02] hover:border-[#e971ff]/60 hover:shadow-[#9351f7]/20",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#9351f7] to-[#e971ff] p-3 rounded-full",children:e.jsx(we,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white text-xl font-bold",children:"Join Existing Lobby"}),e.jsx("p",{className:"text-[#b7b4bb] text-sm",children:"Enter a match in progress"})]})]}),e.jsx("button",{onClick:()=>a("/lobby/join"),className:"w-full bg-gradient-to-r from-[#9351f7] to-[#e971ff] hover:from-[#e971ff] hover:to-[#fc149f] text-white px-6 py-3 rounded-full font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl",children:"Join an Existing Lobby"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 w-full max-w-md mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-xl p-4 border border-[#2a3441]/30 text-center",children:[e.jsx(ze,{size:20,className:"text-[#e971ff] mx-auto mb-2"}),e.jsx("div",{className:"text-white text-lg font-bold",children:c.activeGames}),e.jsx("div",{className:"text-[#b7b4bb] text-xs",children:"Active Games"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-xl p-4 border border-[#2a3441]/30 text-center",children:[e.jsx(we,{size:20,className:"text-[#e971ff] mx-auto mb-2"}),e.jsx("div",{className:"text-white text-lg font-bold",children:c.totalPlayers}),e.jsx("div",{className:"text-[#b7b4bb] text-xs",children:"Players Online"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-xl p-4 border border-[#2a3441]/30 text-center",children:[e.jsx(ue,{size:20,className:"text-[#e971ff] mx-auto mb-2"}),e.jsx("div",{className:"text-white text-lg font-bold",children:c.totalLobbies}),e.jsx("div",{className:"text-[#b7b4bb] text-xs",children:"Total Lobbies"})]})]}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsxs("button",{onClick:()=>a("/"),className:"flex items-center justify-center gap-2 w-full bg-gradient-to-r from-[#7b7583] to-[#838383] hover:from-[#838383] hover:to-[#7b7583] text-white px-6 py-3 rounded-full font-medium transition-all duration-200 hover:scale-105",children:[e.jsx(nt,{size:18}),e.jsx("span",{children:"Back to Home"})]})})]})]})},ce=({onClick:a,children:r,className:s="",disabled:c=!1,variant:l="primary",size:y="default"})=>{const g=()=>{switch(l){case"primary":return"bg-gradient-to-r from-[#741ff5] to-[#9351f7] hover:from-[#9351f7] hover:to-[#e971ff] text-white shadow-lg hover:shadow-xl";case"secondary":return"bg-gradient-to-r from-[#9351f7] to-[#e971ff] hover:from-[#e971ff] hover:to-[#fc149f] text-white shadow-lg hover:shadow-xl";case"outline":return"border-2 border-[#9351f7] text-[#9351f7] hover:bg-[#9351f7] hover:text-white";case"ghost":return"text-white hover:bg-white/10 border border-white/20";default:return"bg-gradient-to-r from-[#741ff5] to-[#9351f7] hover:from-[#9351f7] hover:to-[#e971ff] text-white shadow-lg hover:shadow-xl"}},d=()=>{switch(y){case"small":return"px-4 py-2 text-sm";case"large":return"px-8 py-4 text-lg";default:return"px-6 py-3 text-base"}};return e.jsx("button",{onClick:a,disabled:c,className:`
        w-full
        transform
        rounded-full
        font-semibold
        transition-all
        duration-200
        ease-in-out
        hover:scale-105
        focus:outline-none
        focus:ring-2
        focus:ring-[#9351f7]
        focus:ring-opacity-50
        disabled:transform-none
        disabled:cursor-not-allowed
        disabled:opacity-50
        disabled:bg-gradient-to-r
        disabled:from-[#7b7583]
        disabled:to-[#838383]
        ${g()}
        ${d()}
        ${s}
      `,children:r})},Ce=({placeholder:a,value:r,onChange:s,type:c="text",className:l="",disabled:y=!1,...g})=>e.jsx("input",{type:c,placeholder:a,value:r,onChange:s,disabled:y,className:`
        w-full
        rounded-xl
        border-2
        border-[#2a3441]/50
        bg-gradient-to-r
        from-[#1f152b]
        to-[#0f051d]
        p-4
        text-white
        placeholder-[#b7b4bb]
        transition-all
        duration-200
        focus:border-[#9351f7]
        focus:outline-none
        focus:ring-2
        focus:ring-[#9351f7]/30
        focus:shadow-lg
        focus:shadow-[#9351f7]/20
        hover:border-[#9351f7]/70
        disabled:opacity-50
        disabled:cursor-not-allowed
        disabled:hover:border-[#2a3441]/50
        ${l}
      `,...g}),as={Archer:{name:"Archer",description:"Long reload, high reward.",stats:{reload:"7s",points:"70"},icon:e.jsx(ue,{size:24}),iconColor:"text-green-400",color:"border-green-500",bgColor:"bg-green-500/10"},Shotgun:{name:"Shotgun",description:"Run n' gun specialist.",stats:{reload:"4s",points:"40"},icon:e.jsx(ge,{size:24}),iconColor:"text-orange-400",color:"border-orange-500",bgColor:"bg-orange-500/10"},Pistol:{name:"Pistol",description:"Fast and relentless.",stats:{reload:"1s",points:"10"},icon:e.jsx(Ut,{size:24}),iconColor:"text-cyan-400",color:"border-cyan-500",bgColor:"bg-cyan-500/10"}},rs=Object.values(as),ct=({selectedClass:a,onSelectClass:r})=>e.jsxs("div",{className:"w-full space-y-3 text-left",children:[e.jsx("label",{className:"px-4 text-lg font-medium text-gray-300",children:"Choose your Class"}),e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:rs.map(s=>e.jsxs("button",{type:"button",onClick:()=>r(s.name),className:`
              rounded-lg p-4 text-left transition-all duration-200
              ${a===s.name?`ring-2 ring-purple-500 ${s.bgColor} ${s.color}`:"border-2 border-transparent bg-gray-800/50 hover:bg-gray-700/50"}
            `,children:[e.jsxs("div",{className:`flex items-center gap-3 ${s.iconColor}`,children:[s.icon,e.jsx("h3",{className:"text-xl font-bold text-white",children:s.name})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-400",children:s.description}),e.jsxs("div",{className:"mt-3 flex justify-between text-sm font-semibold text-gray-300",children:[e.jsxs("span",{children:["Reload: ",s.stats.reload]}),e.jsxs("span",{children:["Points: ",s.stats.points]})]})]},s.name))})]}),ns=()=>{const[a,r]=t.useState(""),[s,c]=t.useState(""),[l,y]=t.useState(8),[g,d]=t.useState("Pistol"),[j,h]=t.useState(!1),x=ye(),{sendMessage:w,lastMessage:E,wsStatus:D,ws:R}=he();_e.useEffect(()=>{if(E)try{const I=JSON.parse(E);if(console.log("CreateLobbyPage received message:",I),I.type==="lobby_created")h(!1),console.log("Lobby created successfully, navigating to:",`/lobby/${I.code}/waitlist`),localStorage.setItem("currentUsername",s.trim()),setTimeout(()=>{x(`/lobby/${I.code}/waitlist`)},500);else if(I.type==="lobby_list"&&Array.isArray(I.lobbies)&&I.lobbies.length>0&&j){const Y=I.lobbies[I.lobbies.length-1];Y&&Y.code&&(h(!1),console.log("Using lobby from list, navigating to:",`/lobby/${Y.code}/waitlist`),localStorage.setItem("currentUsername",s.trim()),setTimeout(()=>{x(`/lobby/${Y.code}/waitlist`)},500))}else I.type==="lobby_error"&&(h(!1),console.error("Lobby creation error:",I.message),alert(I.message||"Failed to create lobby."))}catch(I){console.error("Error parsing message in CreateLobbyPage:",I)}},[E,x,j,s]);const J=()=>{if(a.trim()===""){alert("Please provide a Lobby Name");return}if(s.trim()===""){alert("Please enter your username.");return}if(D!=="open"){alert("Connection not ready. Please wait for connection to establish.");return}const I=localStorage.getItem("userId");if(!I){alert("Connection not properly established. Please refresh and try again.");return}h(!0),console.log("Creating lobby with userId:",I,"username:",s.trim()),localStorage.setItem("currentUsername",s.trim());const Y={type:"create_lobby",name:a.trim(),maxPlayers:l,username:s.trim(),role:"player",class:g.toLowerCase()};console.log("Sending create lobby message:",Y),w(Y),localStorage.setItem("playerClass",g.toLowerCase()),setTimeout(()=>{j&&(console.warn("Create lobby timeout, attempting to navigate anyway"),h(!1),w({type:"show_lobbies"}))},5e3)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0f051d] via-[#1f152b] to-[#0f051d] relative overflow-hidden",children:[e.jsx(pe,{}),e.jsxs("header",{className:"flex justify-between items-center py-4 md:py-6 relative z-10 px-4 md:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>x("/lobby"),className:"text-white hover:text-[#e971ff] transition-colors p-2 rounded-full hover:bg-white/10",children:e.jsx(Ne,{size:24})}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:"HBlast"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-[#b7b4bb] text-sm md:text-base",children:"Create Lobby"}),e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10",children:e.jsx("img",{src:"/images/icon.png",alt:"HBlast Score Icon",className:"w-full h-full object-contain"})})]})]}),e.jsx("main",{className:"flex flex-grow flex-col items-center justify-center p-4 md:p-6 relative z-10 min-h-[calc(100vh-120px)]",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-[#741ff5] to-[#9351f7] rounded-full flex items-center justify-center",children:e.jsx(ve,{size:32,className:"text-white"})}),e.jsxs("h1",{className:"text-white text-3xl md:text-4xl font-bold mb-4",children:[e.jsx("span",{className:"block",children:"Create Your"}),e.jsx("span",{className:"block",children:"Arena"})]}),e.jsx("p",{className:"text-[#b7b4bb] text-base md:text-lg",children:"Set up your lobby and dominate as the host"})]}),e.jsx("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-6 md:p-8 border-2 border-[#9351f7]/40 shadow-xl mb-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-[#b7b4bb] mb-2 flex items-center gap-2",children:[e.jsx(it,{size:16,className:"text-[#e971ff]"}),"Your Username (Host)"]}),e.jsx(Ce,{placeholder:"Enter your username",value:s,onChange:I=>c(I.target.value),disabled:j})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-[#b7b4bb] mb-2 flex items-center gap-2",children:[e.jsx(Qt,{size:16,className:"text-[#e971ff]"}),"Lobby Name"]}),e.jsx(Ce,{placeholder:"Enter lobby name",value:a,onChange:I=>r(I.target.value),disabled:j})]}),e.jsxs("div",{className:"bg-gradient-to-r from-[#2a3441]/30 to-transparent rounded-xl p-4 border border-[#2a3441]/20",children:[e.jsxs("label",{className:"flex items-center justify-between text-sm text-[#b7b4bb] mb-3",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(we,{size:16,className:"text-[#e971ff]"}),"Max Players"]}),e.jsx("span",{className:"text-xl font-bold text-[#e971ff]",children:l})]}),e.jsx("input",{type:"range",min:"4",max:"8",step:"1",value:l,onChange:I=>y(Number.parseInt(I.target.value)),disabled:j,className:"w-full h-2 bg-[#2a3441] rounded-lg appearance-none cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, #9351f7 0%, #9351f7 ${(l-4)/4*100}%, #2a3441 ${(l-4)/4*100}%, #2a3441 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-[#b7b4bb] mt-2",children:[e.jsx("span",{children:"4 players"}),e.jsx("span",{children:"8 players"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-[#b7b4bb] mb-3 flex items-center gap-2",children:[e.jsx(ze,{size:16,className:"text-[#e971ff]"}),"Choose Your Class"]}),e.jsx(ct,{selectedClass:g,onSelectClass:d})]}),e.jsx(ce,{onClick:J,disabled:j||!a.trim()||!s.trim()||D!=="open",className:`flex items-center justify-center gap-2 ${j||D!=="open"?"bg-gradient-to-r from-[#7b7583] to-[#838383] cursor-not-allowed":"bg-gradient-to-r from-[#741ff5] to-[#9351f7] hover:from-[#9351f7] hover:to-[#e971ff]"}`,children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Creating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:20}),e.jsx("span",{children:"Create and Join"})]})})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-[#1f152b] to-[#0f051d] rounded-xl p-3 md:p-4 border border-[#2a3441]/30 flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${D==="open"?"bg-green-400 animate-pulse":"bg-red-400"}`}),e.jsx("span",{className:"text-white text-sm font-medium",children:D==="open"?"Connected to Game Network":"Connecting..."}),D==="open"&&e.jsx(ge,{size:16,className:"text-[#e971ff] ml-auto"})]})]})})]})},os=()=>{const[a,r]=t.useState(""),[s,c]=t.useState(""),[l,y]=t.useState("Pistol"),g=ye(),[d,j]=t.useState(!1),{sendMessage:h,lastMessage:x,wsStatus:w,ws:E}=he();_e.useEffect(()=>{if(x)try{const R=JSON.parse(x);if(console.log("JoinLobbyPage received message:",R),R.type==="lobby_joined"){j(!1),console.log("Successfully joined lobby, navigating to waitlist"),localStorage.setItem("currentUsername",s.trim());const J=R.code||a.trim().toUpperCase();setTimeout(()=>{g(`/lobby/${J}/waitlist`)},500)}else R.type==="lobby_error"&&(j(!1),console.error("Join lobby error:",R.message),alert(R.message||"Failed to join lobby."))}catch(R){console.error("Error parsing message in JoinLobbyPage:",R),j(!1)}},[x,g,a,s]);const D=()=>{if(!a.trim()||!s.trim()){alert("Please enter your username and a lobby code.");return}if(w!=="open"){alert("Connection not ready. Please wait for connection to establish.");return}if(!localStorage.getItem("userId")){alert("Connection not properly established. Please refresh and try again.");return}j(!0),localStorage.setItem("currentUsername",s.trim());const J={type:"join_lobby",code:a.trim().toUpperCase(),username:s.trim(),class:l.toLowerCase(),role:"player"};localStorage.setItem("playerClass",l.toLowerCase()),console.log("Joining Lobby with data:",J),h(J),setTimeout(()=>{d&&(console.warn("Join lobby timeout, but will continue to navigation"),j(!1),g(`/lobby/${a.trim().toUpperCase()}/waitlist`))},5e3)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0f051d] via-[#1f152b] to-[#0f051d] relative overflow-hidden",children:[e.jsx(pe,{}),e.jsxs("header",{className:"flex justify-between items-center py-4 md:py-6 relative z-10 px-4 md:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>g("/lobby"),className:"text-white hover:text-[#e971ff] transition-colors p-2 rounded-full hover:bg-white/10",children:e.jsx(Ne,{size:24})}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:"HBlast"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-[#b7b4bb] text-sm md:text-base",children:"Join Lobby"}),e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10",children:e.jsx("img",{src:"/images/icon.png",alt:"HBlast Score Icon",className:"w-full h-full object-contain"})})]})]}),e.jsx("main",{className:"flex flex-grow flex-col items-center justify-center p-4 md:p-6 relative z-10 min-h-[calc(100vh-120px)]",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-[#741ff5] to-[#9351f7] rounded-full flex items-center justify-center",children:e.jsx(et,{size:32,className:"text-white"})}),e.jsxs("h1",{className:"text-white text-3xl md:text-4xl font-bold mb-4",children:[e.jsx("span",{className:"block",children:"Join the"}),e.jsx("span",{className:"block",children:"Battle"})]}),e.jsx("p",{className:"text-[#b7b4bb] text-base md:text-lg",children:"Enter the lobby code and choose your weapon to join the action"})]}),e.jsx("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-6 md:p-8 border-2 border-[#9351f7]/40 shadow-xl mb-6",children:e.jsxs("form",{onSubmit:R=>{R.preventDefault(),D()},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-[#b7b4bb] mb-2 flex items-center gap-2",children:[e.jsx(it,{size:16,className:"text-[#e971ff]"}),"Your Username"]}),e.jsx(Ce,{placeholder:"Enter your username",value:s,onChange:R=>c(R.target.value),disabled:d})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-[#b7b4bb] mb-2 flex items-center gap-2",children:[e.jsx(et,{size:16,className:"text-[#e971ff]"}),"Lobby Code"]}),e.jsx(Ce,{placeholder:"ABCDEF",value:a,onChange:R=>r(R.target.value.toUpperCase()),disabled:d,className:"font-mono text-center text-lg tracking-widest"}),e.jsx("p",{className:"text-xs text-[#b7b4bb] mt-2",children:"Ask the host for the 6-character lobby code"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-[#b7b4bb] mb-3 flex items-center gap-2",children:[e.jsx(ze,{size:16,className:"text-[#e971ff]"}),"Choose Your Class"]}),e.jsx(ct,{selectedClass:l,onSelectClass:y})]}),e.jsx(ce,{type:"submit",disabled:d||!a.trim()||!s.trim()||w!=="open",className:`flex items-center justify-center gap-2 ${d||w!=="open"?"bg-gradient-to-r from-[#7b7583] to-[#838383] cursor-not-allowed":"bg-gradient-to-r from-[#741ff5] to-[#9351f7] hover:from-[#9351f7] hover:to-[#e971ff]"}`,children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Joining..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Jt,{size:20}),e.jsx("span",{children:"Join Lobby"})]})})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-[#1f152b] to-[#0f051d] rounded-xl p-3 md:p-4 border border-[#2a3441]/30 flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${w==="open"?"bg-green-400 animate-pulse":"bg-red-400"}`}),e.jsx("span",{className:"text-white text-sm font-medium",children:w==="open"?"Connected to Game Network":"Connecting..."}),w==="open"&&e.jsx(ge,{size:16,className:"text-[#e971ff] ml-auto"})]})]})})]})},ls=({username:a,lobbyCode:r,onScanComplete:s})=>{const[c,l]=t.useState(!1),[y,g]=t.useState(!1),d=t.useRef(null),j=t.useRef(null),h=t.useRef(null),{sendMessage:x,ws:w}=he(),E=t.useRef(null),[D,R]=t.useState(!1),[J,I]=t.useState(null),Y=t.useRef(null),ne=t.useRef(null),[me,ae]=t.useState(!1),[re,L]=t.useState(null);t.useEffect(()=>c?((async()=>{if(!window.SelfieSegmentation){const S=document.createElement("script");S.src="https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/selfie_segmentation.js",S.async=!0,document.body.appendChild(S),await new Promise((u,P)=>{S.onload=u,S.onerror=P})}if(window.SelfieSegmentation)try{E.current=new window.SelfieSegmentation({locateFile:S=>`https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/${S}`}),E.current.setOptions({modelSelection:1,selfieMode:!1}),E.current.onResults(S=>{I(S.segmentationMask)}),R(!0),console.log("Selfie segmentation loaded")}catch(S){console.error("Failed to initialize MediaPipe SelfieSegmentation:",S)}else console.error("MediaPipe SelfieSegmentation library failed to load.")})(),()=>{E.current&&E.current.close()}):void 0,[c]),t.useEffect(()=>{if(!c||!D||!d.current||!E.current)return;const N=async()=>{d.current&&d.current.videoWidth>0&&d.current.videoHeight>0&&await E.current.send({image:d.current}),Y.current=requestAnimationFrame(N)};return N(),()=>{Y.current&&cancelAnimationFrame(Y.current)}},[c,D]),t.useEffect(()=>{if(!c||!J||!j.current||!d.current)return;const N=j.current,S=N.getContext("2d"),u=d.current;N.width=u.videoWidth,N.height=u.videoHeight,S.clearRect(0,0,N.width,N.height),S.drawImage(u,0,0,N.width,N.height),S.save();const P=document.createElement("canvas");P.width=N.width,P.height=N.height,P.getContext("2d").drawImage(J,0,0,N.width,N.height),S.globalCompositeOperation="destination-in",S.drawImage(P,0,0),S.globalCompositeOperation="source-atop",S.fillStyle="rgba(0,255,0,0.4)",S.fillRect(0,0,N.width,N.height),S.globalCompositeOperation="source-over",S.fillStyle="#00ff00",S.font="24px Arial",S.textAlign="center",S.fillText(a||"Player",N.width/2,30),S.restore()},[J,a,c]),t.useEffect(()=>(c?v():T(),()=>{T()}),[c]);const v=async()=>{try{const N=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:640},height:{ideal:480}}});d.current&&(d.current.srcObject=N,h.current=N)}catch(N){console.error("Error accessing camera:",N),alert("Could not access camera. Please ensure camera permissions are enabled."),l(!1)}},T=()=>{h.current&&(h.current.getTracks().forEach(N=>N.stop()),h.current=null),d.current&&(d.current.srcObject=null),Y.current&&cancelAnimationFrame(Y.current)},H=()=>{if(!d.current||!J)return;const N=d.current;if(!j.current||!N.videoWidth)return;const u=localStorage.getItem("userId");if(!u){console.error("No userId found in localStorage");return}const P=document.createElement("canvas");P.width=J.width,P.height=J.height,P.getContext("2d").drawImage(J,0,0);const M=P.toDataURL("image/png"),_=`playerFaces_${r}`,de=JSON.parse(localStorage.getItem(_)||"{}");if(de[u]={username:a,faceData:M,timestamp:Date.now()},localStorage.setItem(_,JSON.stringify(de)),console.log(`Stored face data for session ${r}, user ${a} (${u})`),w&&w.readyState===WebSocket.OPEN&&r){console.log("Sending face data and person detection to server for",a,"with userId:",u);const B={type:"store_face_data",faceData:M,lobbyCode:r,userId:u};re&&(B.detectionData={bbox:re.bbox,confidence:re.confidence,username:a,userId:u,timestamp:Date.now()},console.log("Including person detection data:",B.detectionData)),w.send(JSON.stringify(B))}else if(x&&r){const B={type:"store_face_data",faceData:M,lobbyCode:r,userId:u};re&&(B.detectionData={bbox:re.bbox,confidence:re.confidence,username:a,userId:u,timestamp:Date.now()},console.log("Including person detection data:",B.detectionData)),x(B)}g(!0),T(),s&&s(M)},W=()=>{l(!0),g(!1)},m=()=>{g(!1),l(!0)};t.useEffect(()=>{if(!c)return;async function N(){try{if(!window.tf){const u=document.createElement("script");u.src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.2.0/dist/tf.min.js",document.head.appendChild(u),await new Promise((P,oe)=>{u.onload=P,u.onerror=()=>oe(new Error("Failed to load TensorFlow.js")),setTimeout(()=>oe(new Error("TensorFlow.js loading timeout")),1e4)})}if(await new Promise(u=>setTimeout(u,500)),!window.cocoSsd){const u=document.createElement("script");u.src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.2/dist/coco-ssd.min.js",document.head.appendChild(u),await new Promise((P,oe)=>{u.onload=P,u.onerror=()=>oe(new Error("Failed to load COCO-SSD")),setTimeout(()=>oe(new Error("COCO-SSD loading timeout")),1e4)})}await new Promise(u=>setTimeout(u,500));const S=await window.cocoSsd.load();ne.current=S,ae(!0),console.log("COCO-SSD model loaded for person detection")}catch(S){console.error("Failed to load detection model:",S),ae(!1)}}N()},[c]);const b=async()=>{if(!(!ne.current||!d.current))try{const S=(await ne.current.detect(d.current)).find(u=>u.class==="person");if(S){const u={bbox:S.bbox,confidence:S.score,username:a,timestamp:Date.now()};L(u),console.log("Detected person during scan:",u)}else L(null)}catch(N){console.error("Error detecting person:",N)}};return t.useEffect(()=>{if(!c||!me)return;const N=setInterval(()=>{b()},200);return()=>clearInterval(N)},[c,me,a]),e.jsxs("div",{className:"flex flex-col items-center space-y-4 rounded-lg bg-gray-800 p-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Player Face Scan"}),!c&&!y&&e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("p",{className:"text-center text-gray-300",children:"Scan your face to improve player detection during the game."}),e.jsxs(ce,{onClick:W,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(Bt,{size:20}),e.jsx("span",{children:"Start Scan"})]})]}),c&&!y&&e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg",children:[e.jsx("video",{ref:d,autoPlay:!0,playsInline:!0,muted:!0,className:"h-64 max-h-64 w-full rounded-lg object-cover"}),e.jsx("canvas",{ref:j,className:"absolute inset-0 h-full w-full object-cover"}),!D&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:e.jsx("p",{className:"text-white",children:"Loading segmentation..."})}),e.jsx("div",{className:"absolute left-0 top-0 h-full w-full border-4 border-indigo-500"})]}),e.jsx("p",{className:"text-sm text-gray-300",children:"Position yourself in the frame until you see the green overlay."}),e.jsxs(ce,{onClick:H,disabled:!D||!J,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:opacity-50",children:[e.jsx(Qe,{size:20}),e.jsx("span",{children:"Capture"})]})]}),y&&e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"rounded-lg border-2 border-green-500 p-1",children:e.jsx("canvas",{ref:j,className:"h-48 w-48 rounded-lg object-cover"})}),e.jsxs("p",{className:"text-center text-green-400",children:[e.jsx(Qe,{size:20,className:"mr-2 inline"}),"Face scan complete!"]}),e.jsxs(ce,{onClick:m,className:"flex items-center gap-2 bg-gray-600 hover:bg-gray-700",children:[e.jsx(Vt,{size:20}),e.jsx("span",{children:"Rescan"})]})]})]})},is=({players:a,currentUser:r,lobbyCode:s,isStarting:c,countdown:l,onReadyToggle:y,onNameChange:g})=>{const{sendMessage:d,lastMessage:j,wsStatus:h}=he(),[x,w]=t.useState(!1),[E,D]=t.useState(""),[R,J]=t.useState(!1),[I,Y]=t.useState(120),[ne,me]=t.useState(!0),[ae,re]=t.useState(!1),L=M=>{switch(M?.toLowerCase()){case"pistol":return{name:"Pistol",icon:e.jsx(ue,{size:16,className:"text-blue-400"}),color:"text-blue-400",bgColor:"bg-blue-400/20",borderColor:"border-blue-400/40"};case"shotgun":return{name:"Shotgun",icon:e.jsx(lt,{size:16,className:"text-red-400"}),color:"text-red-400",bgColor:"bg-red-400/20",borderColor:"border-red-400/40"};case"archer":return{name:"Bow",icon:e.jsx(Fe,{size:16,className:"text-green-400"}),color:"text-green-400",bgColor:"bg-green-400/20",borderColor:"border-green-400/40"};default:return{name:"Unknown",icon:e.jsx(ue,{size:16,className:"text-gray-400"}),color:"text-gray-400",bgColor:"bg-gray-400/20",borderColor:"border-gray-400/40"}}};t.useEffect(()=>{if(!(!ne||!r)&&!r.isReady)if(I>0){const M=setTimeout(()=>Y(_=>_-1),1e3);return()=>clearTimeout(M)}else I===0&&ne&&!r.isReady&&(a&&a.length>0&&r&&s&&(R?(d({type:"set_ready",code:s,ready:!0}),re(!1)):re(!0)),me(!1))},[I,ne,a,r,s,d,R]),t.useEffect(()=>{I===0&&!ne&&ae&&R&&a&&a.length>0&&r&&s&&!r.isReady&&(d({type:"set_ready",code:s,ready:!0}),re(!1))},[R,I,ne,ae,a,r,s,d]);const v=t.useRef(r?.isReady);t.useEffect(()=>{if(!r)return;const M=v.current,_=r.isReady;M&&!_?(console.log("Player went from ready to not ready, restarting countdown"),Y(120),me(!0),re(!1)):!M&&_&&(console.log("Player went from not ready to ready, stopping countdown"),me(!1),re(!1)),v.current=_},[r?.isReady]),t.useEffect(()=>{!R&&r&&!r.isReady&&(Y(120),me(!0),re(!1))},[R,r]);const T=t.useRef(null),H=t.useRef(!1),W=t.useRef(null),m=t.useRef(!1);t.useEffect(()=>{if(r){const M=localStorage.getItem("currentUsername");D(M||r.name);try{const _=`playerFaces_${s}`,de=JSON.parse(localStorage.getItem(_)||"{}"),B=localStorage.getItem("userId");B&&de[B]&&(J(!0),console.log(`Face scan already complete for user ${r.name} in session ${s}`))}catch(_){console.error("Error checking face scan status:",_)}}},[r,s]),t.useEffect(()=>(T.current=new Audio("/sounds/Countdown.mp3"),W.current=new Audio("/sounds/Ready.mp3"),()=>{T.current&&(T.current.pause(),T.current=null),W.current&&(W.current.pause(),W.current=null)}),[]),t.useEffect(()=>{r&&(r.isReady&&!m.current?(W.current&&(W.current.volume=.7,W.current.currentTime=0,W.current.play().catch(()=>{})),m.current=!0):r.isReady||(m.current=!1))},[r?.isReady]),t.useEffect(()=>{c&&!H.current?T.current&&(T.current.volume=.7,T.current.currentTime=0,T.current.play().catch(M=>console.error("Error playing sound:",M)),H.current=!0):c||(H.current=!1)},[c]);const b=()=>{if(r){const M=localStorage.getItem("currentUsername");D(M||r.name),w(!0)}},N=()=>{E.trim()!==""&&(localStorage.setItem("currentUsername",E.trim()),g(E.trim()),w(!1))},S=()=>{if(!r||!s){console.log("PlayerWaitlistPage: Cannot toggle ready - missing currentUser or lobbyCode"),console.log("currentUser:",r),console.log("lobbyCode:",s);return}const _=localStorage.getItem("userId")||r.id;console.log("PlayerWaitlistPage: Toggling ready state"),console.log("- User ID:",_),console.log("- Current ready state:",r.isReady),console.log("- Is host:",r.isHost),console.log("- Lobby code:",s);const de={type:"set_ready",code:s,userId:_,ready:!r.isReady};console.log("Sending ready message:",de),d(de),y&&typeof y=="function"&&(console.log("Also calling fallback onReadyToggle"),y())},u=()=>{J(!0),console.log("Face scan completed")},P=()=>{J(!1),console.log("Face scan reset - starting rescan"),r&&r.isReady&&(console.log("User was ready, unreadying due to face rescan"),S())};if(!r&&!c)return e.jsx("div",{className:"text-center px-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-3xl p-8 border border-[#2a3441]/30 max-w-sm mx-auto",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-[#e971ff] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-[#b7b4bb]",children:"Loading battle data..."})]})});if(c)return e.jsx("div",{className:"text-center px-4",children:e.jsxs("div",{className:"max-w-sm mx-auto",children:[e.jsxs("div",{className:"relative mx-auto h-40 w-40 mb-8",children:[e.jsxs("svg",{className:"h-full w-full transform -rotate-90",viewBox:"0 0 100 100",children:[e.jsx("circle",{className:"stroke-[#2a3441]",strokeWidth:"6",cx:"50",cy:"50",r:"40",fill:"transparent"}),e.jsx("circle",{className:"stroke-[#e971ff] transition-all duration-1000 linear drop-shadow-lg",strokeWidth:"6",strokeDasharray:"251.2",strokeDashoffset:251.2-l/3*251.2,strokeLinecap:"round",cx:"50",cy:"50",r:"40",fill:"transparent"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"text-5xl font-bold text-white drop-shadow-lg",children:l})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-3xl p-6 border-2 border-[#e971ff]/40 shadow-2xl",children:[e.jsx("h3",{className:"text-3xl font-bold text-white mb-2",children:"Battle Begins!"}),e.jsx("p",{className:"text-[#b7b4bb] mb-4",children:"Lock and load, warrior!"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-[#e971ff]",children:[e.jsx(ge,{size:20,className:"animate-pulse"}),e.jsx("span",{className:"text-sm font-medium",children:"Weapons charging..."})]})]})]})});const oe=a.filter(M=>M.isReady).length;return e.jsxs("div",{className:"space-y-4 px-4",children:[r?.isReady?e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsxs("div",{className:"flex items-center gap-2 bg-gradient-to-r from-green-500 to-emerald-500 px-4 py-2 rounded-full shadow-lg",children:[e.jsx(Re,{size:18,className:"text-white animate-pulse"}),e.jsx("span",{className:"text-white font-bold text-sm",children:"READY"})]})}):e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsxs("div",{className:"flex items-center gap-2 bg-gradient-to-r from-orange-500 to-red-500 px-3 py-2 rounded-full shadow-lg",children:[e.jsx(rt,{size:16,className:"text-white"}),e.jsxs("span",{className:"text-white font-mono text-sm font-bold",children:[I,"s"]})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-[#1f152b] via-[#2a1b3d] to-[#1f152b] rounded-2xl p-4 border border-[#9351f7]/30 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(we,{size:20,className:"text-[#e971ff]"}),"Battle Squad"]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-[#e971ff]",children:[oe,"/",a.length]}),e.jsx("div",{className:"text-xs text-[#b7b4bb]",children:"ready"})]})]}),e.jsx("div",{className:"bg-[#0f051d] rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#741ff5] to-[#e971ff] transition-all duration-500",style:{width:`${a.length>0?oe/a.length*100:0}%`}})})]}),e.jsx("div",{className:"space-y-3",children:a.map((M,_)=>{const de=L(M.class),B=M.id===r?.id;return e.jsxs("div",{className:`
                relative overflow-hidden rounded-2xl border-2 transition-all duration-300 
                ${B?"bg-gradient-to-r from-[#9351f7]/20 via-[#e971ff]/10 to-[#9351f7]/20 border-[#e971ff]/50 shadow-lg shadow-[#e971ff]/20":M.isReady?"bg-gradient-to-r from-green-500/10 to-emerald-500/10 border-green-400/40":"bg-gradient-to-r from-[#1f152b] to-[#0f051d] border-[#2a3441]/30"}
                hover:scale-[1.02] hover:shadow-xl
              `,children:[e.jsx("div",{className:`absolute top-2 left-2 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${M.isHost?"bg-yellow-400 text-black":"bg-[#9351f7] text-white"}`,children:M.isHost?e.jsx(ve,{size:12}):_+1}),e.jsx("div",{className:"p-4 pl-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:x&&B?e.jsx(Ce,{value:E,onChange:je=>D(je.target.value),className:"text-base font-bold"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`font-bold text-lg truncate ${B?"text-[#e971ff]":"text-white"}`,children:B&&localStorage.getItem("currentUsername")?localStorage.getItem("currentUsername"):M.name}),B&&e.jsx("span",{className:"bg-[#e971ff]/20 text-[#e971ff] px-2 py-1 rounded-full text-xs font-medium",children:"YOU"}),M.isHost&&e.jsx("span",{className:"bg-yellow-400/20 text-yellow-400 px-2 py-1 rounded-full text-xs font-medium",children:"HOST"})]})}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full border ${de.bgColor} ${de.borderColor}`,children:[de.icon,e.jsx("span",{className:`text-sm font-medium ${de.color}`,children:de.name})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1 ml-4",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${M.isReady?"bg-green-500":"bg-red-500/70"}`,children:M.isReady?e.jsx(Re,{size:18,className:"text-white"}):e.jsx(De,{size:18,className:"text-white"})}),e.jsx("span",{className:`text-xs font-medium ${M.isReady?"text-green-400":"text-red-400"}`,children:M.isReady?"READY":"WAIT"})]})]})}),M.isReady&&e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-r from-transparent via-green-400/10 to-transparent animate-pulse"})})]},M.id)})}),r&&!c&&e.jsx("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-4 border border-[#2a3441]/30 shadow-xl",children:e.jsx(ls,{username:localStorage.getItem("currentUsername")||r.name,lobbyCode:s,onScanComplete:u,onScanReset:P})}),e.jsxs("div",{className:"space-y-3 pb-4",children:[ae&&!R&&e.jsx("div",{className:"bg-gradient-to-r from-red-500/20 to-orange-500/20 border-2 border-red-400/50 rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx(De,{size:18,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-red-400 font-bold",children:"Face Scan Required"}),e.jsx("div",{className:"text-red-300 text-sm",children:"Complete your scan to ready up!"})]})]})}),x?e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(ce,{onClick:N,className:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{size:18}),e.jsx("span",{children:"Save"})]})}),e.jsx(ce,{onClick:()=>w(!1),variant:"outline",className:"border-2 border-[#2a3441] text-[#b7b4bb] hover:bg-[#2a3441] bg-transparent rounded-xl",children:"Cancel"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(ce,{onClick:S,disabled:x||!R,className:`
                w-full py-4 rounded-2xl font-bold text-lg transition-all duration-200 transform hover:scale-[1.02]
                ${r?.isReady?"bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-orange-500 hover:to-red-500 shadow-lg shadow-yellow-500/30":"bg-gradient-to-r from-green-600 to-emerald-500 hover:from-emerald-500 hover:to-green-400 shadow-lg shadow-green-500/30"}
                ${R?"":"opacity-50 cursor-not-allowed transform-none"}
              `,children:e.jsx("div",{className:"flex items-center justify-center gap-3",children:r?.isReady?e.jsxs(e.Fragment,{children:[e.jsx(De,{size:24}),e.jsx("span",{children:"Cancel Ready"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{size:24}),e.jsx("span",{children:"Ready for Battle!"})]})})}),e.jsx(ce,{onClick:b,variant:"outline",className:"w-full py-3 border-2 border-[#9351f7]/40 text-[#e971ff] hover:bg-[#9351f7]/20 bg-transparent rounded-xl",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Yt,{size:18}),e.jsx("span",{children:"Edit Name"})]})})]})]})]})},cs=()=>{const{lobbyId:a}=Me(),r=ye(),{lastMessage:s,sendMessage:c,wsStatus:l,ws:y}=he(),[g,d]=t.useState([]),[j,h]=t.useState("Game Lobby"),[x,w]=t.useState(null),[E,D]=t.useState(!1),[R,J]=t.useState(30),[I,Y]=t.useState(!1),[ne,me]=t.useState([]),[ae,re]=t.useState(0),L=m=>{const b=new Date().toLocaleTimeString();me(N=>[`[${b}] ${m}`,...N.slice(0,9)]),console.log(`[WaitlistPage Debug] ${m}`)},v=t.useMemo(()=>{if(!x||!g||g.length===0)return null;L(`Finding current user with ID: ${x}, available players: ${g.length}`);const m=g.find(b=>b.id===x);return L(m?`Found current user: ${m.name}`:"Current user not found in players list"),m||null},[g,x]);t.useMemo(()=>g.length>0&&g.every(m=>m.isReady),[g]),t.useEffect(()=>{if(l==="open"&&a){L("WebSocket connection ready, initializing waitlist page");const m=localStorage.getItem("userId");m?(L(`Setting currentUserId from localStorage: ${m}`),w(m)):(L("No userId found in localStorage - clearing potentially stale data"),localStorage.removeItem("currentUsername"),localStorage.removeItem("playerClass"));const b=localStorage.getItem("currentUsername");b&&m&&L(`Found stored username: ${b}`),L(`Requesting lobby members for: ${a}`),c({type:"get_lobby_members",code:a});const N=setTimeout(()=>{L("Initialization timeout reached"),Y(!0)},3e3);return()=>clearTimeout(N)}else L(`WebSocket not ready. Status: ${l}, LobbyId: ${a}`)},[l,a,c]),t.useEffect(()=>{if(x&&g.length===0&&l==="open"&&I&&ae<5){L(`Retry attempt ${ae+1}: No players found, requesting lobby members again`);const m=setTimeout(()=>{c({type:"get_lobby_members",code:a}),re(b=>b+1)},2e3*(ae+1));return()=>clearTimeout(m)}},[x,g.length,l,a,c,I,ae]),t.useEffect(()=>{if(ae>=5&&g.length===0){L("Maximum retries reached, creating fallback user data");const m=localStorage.getItem("currentUsername"),b=localStorage.getItem("userId");b&&m&&(d([{id:b,name:m,isHost:!0,isReady:!1,class:localStorage.getItem("playerClass")||"pistol"}]),L("Created fallback user data"))}},[ae,g.length]),t.useEffect(()=>{if(l==="open"&&a&&I&&g.length>0){const m=setInterval(()=>{L("Periodic refresh of lobby members"),c({type:"get_lobby_members",code:a})},1e4);return()=>clearInterval(m)}},[l,a,c,I,g.length]),t.useEffect(()=>{if(s)try{const m=JSON.parse(s);if(L(`Processing message: ${m.type}`),m.type==="welcome"&&m.userId){const b=localStorage.getItem("userId");b&&b!==m.userId&&(L(`Server assigned new userId ${m.userId}, clearing stale data`),localStorage.removeItem("currentUsername"),localStorage.removeItem("playerClass"),Object.keys(localStorage).forEach(N=>{(N.startsWith("playerFaces_")||N.startsWith("playerIdentities_"))&&localStorage.removeItem(N)})),localStorage.setItem("userId",m.userId),w(m.userId),L(`Set userId to: ${m.userId}`)}if(!x){const b=localStorage.getItem("userId");b&&(L(`Setting currentUserId from localStorage: ${b}`),w(b))}if(m.type==="lobby_members"&&m.code===a){L(`Received lobby_members: ${JSON.stringify(m.members)}`);const b=localStorage.getItem("currentUsername"),N=localStorage.getItem("userId"),S=m.members.map(u=>{let P;return u.username&&u.username.trim()?(P=u.username.trim(),L(`Using server username for ${u.userId}: ${P}`)):u.userId===N&&b?(P=b,L(`Using stored username for current user ${u.userId}: ${P}`)):(P=`Player ${u.userId?.substring(0,4)||"Unknown"}`,L(`Using fallback username for ${u.userId}: ${P}`)),{id:u.userId,name:P,isHost:u.isHost||!1,isReady:!!u.isReady,class:u.class||"pistol"}});if(d(S),Y(!0),L(`Updated players: ${JSON.stringify(S)}`),!x){const u=localStorage.getItem("userId");u&&(L(`Setting currentUserId from localStorage after receiving lobby_members: ${u}`),w(u))}}else if(m.type==="lobby_state_update"){const b=localStorage.getItem("currentUsername"),N=localStorage.getItem("userId"),S=m.players.map(u=>{let P;return u.username&&u.username.trim()?P=u.username.trim():(u.userId||u.id)===N&&b?P=b:P=`Player ${(u.userId||u.id)?.substring(0,4)||"Unknown"}`,{id:u.userId||u.id,name:P,isHost:u.isHost||!1,isReady:!!u.isReady,class:u.class||"pistol"}});d(S),h(m.lobbyName||"Game Lobby"),m.currentUserId&&w(m.currentUserId),L("Updated from lobby_state_update")}else m.type==="game_start_countdown"?(D(!0),J(m.countdown),L("Game countdown started")):m.type==="game_started"?(L("Game started, navigating to game page"),r(`/game/${a}`)):m.type==="lobby_error"&&L(`Lobby error: ${m.message}`)}catch(m){L(`Failed to parse WebSocket message: ${m.message}`)}},[s,a,r,x]),t.useEffect(()=>{let m;return E&&R>0?m=setInterval(()=>J(b=>b-1),1e3):E&&R===0&&setTimeout(()=>{r(`/game/${a}`)},1e3),()=>clearInterval(m)},[E,R,a,r]);const T=()=>{if(!x||!a){L("Cannot toggle ready: missing currentUserId or lobbyId");return}L(`Toggling ready state for user: ${x} in lobby: ${a}`),c({type:"set_ready",code:a,userId:x,ready:v?!v.isReady:!0}),d(g.map(m=>m.id===x?{...m,isReady:!m.isReady}:m))},H=m=>{if(!x||!a){L("Cannot change name: missing currentUserId or lobbyId");return}L(`Changing name for user: ${x} to: ${m}`),localStorage.setItem("currentUsername",m),c({type:"set_name",code:a,userId:x,username:m}),d(g.map(b=>b.id===x?{...b,name:m}:b))},W=()=>{L("Manual retry requested"),re(0),Y(!1),c({type:"get_lobby_members",code:a})};return!I||l==="open"&&g.length===0&&ae<5?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0f051d] via-[#1f152b] to-[#0f051d] relative overflow-hidden",children:[e.jsx(pe,{}),e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-center px-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-3xl p-8 border border-[#2a3441]/30 max-w-md mx-auto",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-[#e971ff] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-[#b7b4bb] mb-2",children:"Loading battle data..."}),e.jsxs("p",{className:"text-[#b7b4bb] text-sm mb-4",children:["Connecting to lobby ",a?.toUpperCase()]}),e.jsxs("div",{className:"text-left bg-black/30 rounded p-3 text-xs text-gray-400 mb-4 max-h-32 overflow-y-auto",children:[e.jsx("div",{className:"font-bold mb-1",children:"Debug Info:"}),ne.map((m,b)=>e.jsx("div",{children:m},b))]}),e.jsxs("div",{className:"text-xs text-[#b7b4bb] mb-4",children:["WebSocket: ",l," | Retries: ",ae,"/5"]}),e.jsx(ce,{onClick:W,className:"bg-gradient-to-r from-[#741ff5] to-[#9351f7] text-white px-4 py-2 rounded-lg text-sm",children:"Retry Connection"})]})})})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0f051d] via-[#1f152b] to-[#0f051d] relative overflow-hidden",children:[e.jsx(pe,{}),e.jsxs("header",{className:"flex justify-between items-center py-4 md:py-6 relative z-10 px-4 md:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[!E&&e.jsx("button",{onClick:()=>r("/lobby"),className:"text-white hover:text-[#e971ff] transition-colors p-2 rounded-full hover:bg-white/10",children:e.jsx(Ne,{size:24})}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:"HBlast"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-[#b7b4bb] text-sm md:text-base",children:j}),e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10",children:e.jsx("img",{src:"/images/icon.png",alt:"HBlast Score Icon",className:"w-full h-full object-contain"})})]})]}),e.jsx("div",{className:"text-center mb-6 px-4 relative z-10",children:e.jsxs("div",{className:"inline-block bg-gradient-to-r from-[#1f152b] to-[#0f051d] border-2 border-[#9351f7]/40 rounded-xl px-4 md:px-6 py-2 md:py-3 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsx("span",{className:"text-sm text-[#b7b4bb]",children:"Lobby Code: "}),e.jsx("span",{className:"text-lg md:text-xl font-mono font-bold text-[#e971ff] tracking-widest",children:a?.toUpperCase()})]})}),e.jsx("main",{className:"flex flex-grow flex-col justify-center p-4 md:p-6 relative z-10",children:e.jsxs("div",{className:"mx-auto w-full max-w-2xl",children:[e.jsx(is,{players:g,currentUser:v||{id:x,name:localStorage.getItem("currentUsername")||"You",isHost:!1,isReady:!1},lobbyCode:a,isStarting:E,countdown:R,onReadyToggle:T,onNameChange:H}),E&&e.jsxs("div",{className:"mb-6 text-center text-2xl font-bold text-[#e971ff]",children:["Game starting in ",R,"..."]})]})}),!E&&e.jsx("footer",{className:"p-4 relative z-10",children:e.jsx("div",{className:"mx-auto max-w-md",children:e.jsxs(ce,{onClick:()=>r("/lobby"),variant:"outline",className:"flex items-center justify-center gap-2 border-red-500 text-red-400 hover:bg-red-500 hover:text-white bg-transparent",children:[e.jsx(ot,{size:20}),e.jsx("span",{children:"Leave Lobby"})]})})})]})},ds=()=>{const{gameId:a}=Me(),r=ye(),s=t.useRef(null),c=t.useRef(null),l=t.useRef(null),y=t.useRef(null),g=t.useRef(null),d=t.useRef(1),j=t.useRef([]),[h,x]=t.useState(!1),[w,E]=t.useState([]),D=t.useRef(null),[R,J]=t.useState(!1),[I,Y]=t.useState(null),[ne,me]=t.useState(100),[ae,re]=t.useState(0),[L,v]=t.useState(100),[T,H]=t.useState(!1),[W,m]=t.useState(!1),[b,N]=t.useState(!1),[S,u]=t.useState(3),P=t.useRef(null),oe=t.useRef(null);t.useEffect(()=>(P.current=new Audio("/sounds/laser-hit.mp3"),oe.current=new Audio("/sounds/laser-miss.mp3"),P.current.volume=.7,oe.current.volume=.7,P.current.preload="auto",oe.current.preload="auto",()=>{P.current=null,oe.current=null}),[]);const M=i=>{if(i.current)try{i.current.currentTime=0,i.current.play()}catch(n){console.log("Sound play error:",n)}};t.useEffect(()=>{if(b)if(S>0){const i=setTimeout(()=>u(n=>n-1),1e3);return()=>clearTimeout(i)}else N(!1)},[b,S]),t.useEffect(()=>{let i;return W||(i=setInterval(()=>{v(n=>n<=1?(clearInterval(i),0):n-1)},1e3)),()=>clearInterval(i)},[a,r,W]);const{ws:_,wsStatus:de}=he(),[B,je]=t.useState({});t.useEffect(()=>{console.log("🧹 CLEANUP: Clearing localStorage data from previous sessions");const i=`playerFaces_${a}`,n=`playerIdentities_${a}`;for(let f=localStorage.length-1;f>=0;f--){const p=localStorage.key(f);p&&(p.startsWith("playerFaces_")&&p!==i&&(console.log(`🧹 CLEANUP: Removing old face scan data: ${p}`),localStorage.removeItem(p)),p.startsWith("playerIdentities_")&&p!==n&&(console.log(`🧹 CLEANUP: Removing old player identities: ${p}`),localStorage.removeItem(p)),(p==="playerIdentities"||p==="lobbyPlayers")&&(console.log(`🧹 CLEANUP: Removing generic old data: ${p}`),localStorage.removeItem(p)))}const o=localStorage.getItem(n);if(o)try{const f=JSON.parse(o);console.log(`🎮 CLIENT: Restored player identities for session ${a}:`,f),je(f)}catch(f){console.error("Error parsing stored player identities:",f)}},[a]),t.useEffect(()=>{if(console.log(`🎮 CLIENT: PlayerPage useEffect called. WebSocket status: ${de}, ws exists: ${!!_}`),!_){console.log("🎮 CLIENT: No WebSocket connection available, waiting...");return}if(console.log(`🎮 CLIENT: WebSocket readyState: ${_.readyState} (0=CONNECTING, 1=OPEN, 2=CLOSING, 3=CLOSED)`),_.readyState!==WebSocket.OPEN){console.log("🎮 CLIENT: WebSocket not ready, waiting for connection...");return}a&&(console.log("🎮 CLIENT: Requesting player identities for lobby:",a),_.send(JSON.stringify({type:"get_player_identities",lobbyCode:a})));const i=n=>{try{const o=JSON.parse(n.data);if(console.log("🎮 CLIENT: Received WebSocket message:",o.type,o),o.type==="player_identities"||o.type==="player_identities_updated"){console.log("🎮 CLIENT: Received player identities from server:",o.playerIdentities),o.playerIdentities&&(je(o.playerIdentities),localStorage.setItem(`playerIdentities_${a}`,JSON.stringify(o.playerIdentities)),console.log(`🎮 CLIENT: Updated player identities for lobby ${a}`));return}if(o.type==="game_start")if(console.log("🎮 CLIENT: Received game start data:",o),console.log("🎮 CLIENT: Raw playerIdentities received:",JSON.stringify(o.playerIdentities,null,2)),console.log("🎮 CLIENT: Clearing any existing identity data"),je({}),localStorage.removeItem("playerIdentities"),localStorage.removeItem("lobbyPlayers"),o.playerPositions&&(console.log("🎮 CLIENT: Received player positions:",o.playerPositions),localStorage.setItem("lobbyPlayers",JSON.stringify(o.playerPositions))),o.playerIdentities){console.log("🎮 CLIENT: Received player identities:",o.playerIdentities),console.log("🎮 CLIENT: Player identities structure:",Object.keys(o.playerIdentities).map(p=>({position:p,username:o.playerIdentities[p].username,userId:o.playerIdentities[p].userId,hasDetectionData:!!o.playerIdentities[p].detectionData,detectionData:o.playerIdentities[p].detectionData}))),localStorage.setItem("playerIdentities",JSON.stringify(o.playerIdentities)),je(o.playerIdentities),console.log("🎮 CLIENT: Pre-populating person tracking with known identities"),console.log("🎮 CLIENT: Available identities:",o.playerIdentities);const f=Object.keys(o.playerIdentities).length;d.current=f+1,j.current=[],E([]),console.log(`🎮 CLIENT: Set next person ID to ${d.current} based on ${f} known identities`)}else{console.log("No playerIdentities received, creating from available data");const f=o.playerPositions||JSON.parse(localStorage.getItem("lobbyPlayers")||"{}");if(Object.keys(f).length>0){console.log("Creating identities from lobby players:",f);const p={};Object.keys(f).forEach(C=>{p[C]={username:f[C],userId:null}}),localStorage.setItem("playerIdentities",JSON.stringify(p)),je(p),d.current=Object.keys(p).length+1,j.current=[],E([]),console.log("Created fallback identities:",p)}}o.type==="game_end"&&r(`/game/${a}/end`)}catch(o){console.error("Error handling WebSocket message:",o)}};return _.addEventListener("message",i),console.log("🎮 CLIENT: PlayerPage mounted, waiting for fresh game_start data..."),()=>{_.removeEventListener("message",i)}},[_,r,a]),t.useEffect(()=>{async function i(){try{if(!window.tf){const o=document.createElement("script");o.src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.2.0/dist/tf.min.js",document.head.appendChild(o),await new Promise((f,p)=>{o.onload=f,o.onerror=()=>p(new Error("Failed to load TensorFlow.js")),setTimeout(()=>p(new Error("TensorFlow.js loading timeout")),3e4)})}if(await new Promise(o=>setTimeout(o,1e3)),!window.cocoSsd){const o=document.createElement("script");o.src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.2/dist/coco-ssd.min.js",document.head.appendChild(o),await new Promise((f,p)=>{o.onload=f,o.onerror=()=>p(new Error("Failed to load COCO-SSD")),setTimeout(()=>p(new Error("COCO-SSD loading timeout")),3e4)})}await new Promise(o=>setTimeout(o,1e3));const n=await window.cocoSsd.load();y.current=n,x(!0)}catch{x(!1)}}i()},[]);const $e=t.useCallback((i,n)=>{const o=i[0]+i[2]/2,f=i[1]+i[3]/2,p=n[0]+n[2]/2,C=n[1]+n[3]/2;return Math.sqrt(Math.pow(p-o,2)+Math.pow(C-f,2))},[]),Oe=t.useCallback((i,n)=>{const[o,f,p,C]=i,[$,U,O,z]=n,G=Math.max(o,$),Z=Math.max(f,U),q=Math.min(o+p,$+O),le=Math.min(f+C,U+z);if(q<G||le<Z)return 0;const k=(q-G)*(le-Z),Q=p*C,F=O*z,X=Q+F-k;return k/X},[]),dt=t.useCallback((i,n,o,f)=>{const p=Oe(i,n),[,,C,$]=i,[,,U,O]=n,z=C*$,G=U*O,Z=Math.min(z,G)/Math.max(z,G),q=C/$,le=U/O,k=Math.min(q,le)/Math.max(q,le),Q=i[0]+C/2,F=i[1]+$/2,X=n[0]+U/2,ee=n[1]+O/2,se=Math.sqrt(640*640+480*480),V=Math.sqrt(Math.pow(X-Q,2)+Math.pow(ee-F,2)),ie=1-Math.min(V/se,1),xe=(o+f)/2,fe=Math.min(xe/.7,1),te={iou:.4,size:.2,aspect:.15,position:.15,confidence:.1};return{overall:p*te.iou+Z*te.size+k*te.aspect+ie*te.position+fe*te.confidence,components:{iou:p,size:Z,aspect:k,position:ie,confidence:fe}}},[Oe]),We=t.useCallback(i=>{const o=[],f=new Set;j.current.forEach($=>{let U=null,O=1/0,z=-1;i.forEach((G,Z)=>{if(f.has(Z))return;const q=$e($.bbox,G.bbox);q<O&&q<150&&(O=q,U=G,z=Z)}),U?(o.push({...$,bbox:U.bbox,confidence:U.score,lastSeen:Date.now(),isVisible:!0}),f.add(z)):o.push({...$,isVisible:!1})}),i.forEach(($,U)=>{if(f.has(U))return;let O=!1;for(let z=0;z<o.length;z++){const G=o[z];if(!G.isVisible&&Date.now()-G.lastSeen<3e3&&$e(G.bbox,$.bbox)<250){o[z]={...G,bbox:$.bbox,confidence:$.score,lastSeen:Date.now(),isVisible:!0},f.add(U),O=!0;break}}if(!O){let z=null,G=null,Z=!1,q=null;try{const k=Object.keys(B).length>0?B:{};if(console.log("🔍 ASSIGNMENT: Available identities for assignment:",k),console.log("🔍 ASSIGNMENT: Available identity positions:",Object.keys(k)),console.log("🔍 ASSIGNMENT: Available identity details:",Object.keys(k).map(Q=>({position:Q,username:k[Q].username,userId:k[Q].userId,hasDetectionData:!!k[Q].detectionData}))),!Z&&Object.keys(k).length>0){console.log("🔍 BBOX: Attempting bbox matching for new detection:",$.bbox);const Q=new Set(j.current.filter(se=>se.userId).map(se=>se.userId));console.log("🔍 BBOX: Currently used user IDs:",Array.from(Q));let F=null,X=0;const ee=.4;Object.keys(k).forEach(se=>{const V=k[se];if(V.userId&&Q.has(V.userId)){console.log(`🔍 BBOX: Skipping ${V.username} (userId ${V.userId}) - already used`);return}if(V.detectionData&&V.detectionData.bbox){const K=V.detectionData.bbox,ie=$.bbox,xe=V.detectionData.confidence||.5,fe=$.score||.5,te=dt(K,ie,xe,fe);console.log(`🔍 BBOX: Enhanced similarity between stored (${V.username}) and current detection:`,{overall:te.overall.toFixed(3),iou:te.components.iou.toFixed(3),size:te.components.size.toFixed(3),aspect:te.components.aspect.toFixed(3),position:te.components.position.toFixed(3),confidence:te.components.confidence.toFixed(3)}),te.overall>X&&te.overall>ee&&(X=te.overall,F={position:se,identity:V,similarity:te.overall,components:te.components})}else console.log(`🔍 BBOX: Identity ${V.username} has no detection data for bbox matching`)}),F?(z=F.identity.username,G=F.identity.userId,q=parseInt(F.position),Z=!0,console.log(`🎯 BBOX MATCH FOUND! Assigned ${z} based on enhanced similarity (${(F.similarity*100).toFixed(1)}%)`),console.log(`🎯 BBOX COMPONENTS: IoU=${(F.components.iou*100).toFixed(1)}%, Size=${(F.components.size*100).toFixed(1)}%, Aspect=${(F.components.aspect*100).toFixed(1)}%, Position=${(F.components.position*100).toFixed(1)}%, Confidence=${(F.components.confidence*100).toFixed(1)}%`)):console.log(`🔍 BBOX: No good enhanced matches found (best was ${(X*100).toFixed(1)}%, needed ${(ee*100).toFixed(1)}%), proceeding with normal assignment...`)}if(!Z&&Object.keys(k).length>0){console.log("🔄 FALLBACK: No bbox match, trying unused identity assignment...");const Q=new Set(j.current.filter(X=>X.userId).map(X=>X.userId));console.log("🔄 FALLBACK: Currently used user IDs:",Array.from(Q));const F=Object.keys(k).find(X=>{const ee=k[X];if(ee.userId){const se=Q.has(ee.userId);return console.log(`🔄 FALLBACK: Checking identity ${ee.username} (userId: ${ee.userId}) - used: ${se}`),!se}else{const se=new Set(j.current.filter(K=>K.username&&!K.username.startsWith("Player ")).map(K=>K.username)),V=ee.username&&se.has(ee.username);return console.log(`🔄 FALLBACK: Checking identity ${ee.username} (no userId) - used: ${V}`),ee.username&&!V}});if(F){const X=k[F];z=X.username,G=X.userId,q=parseInt(F),Z=!0,console.log(`🎯 FALLBACK SUCCESS: New detection assigned to ${z} (unused identity at position ${F})`)}else console.log("🔄 FALLBACK: No unused identities found")}Z||(q=d.current++,z=`Player ${q}`,console.log(`❌ GENERIC: No unused identity found, creating new player with ID ${q} (${z})`)),console.log(`🎯 FINAL ASSIGNMENT: Creating new person with username="${z}", userId="${G}", id="${q}", assignedFromIdentity=${Z}`)}catch(k){console.error("Error getting identity for new detection:",k),q=d.current++,z=`Player ${q}`}const le={id:q,username:z,userId:G,bbox:$.bbox,confidence:$.score,lastSeen:Date.now(),isVisible:!0};console.log("Created new person:",le),o.push(le),f.add(U)}});const p=Date.now(),C=o.filter($=>p-$.lastSeen<15e3);return j.current=C,C.filter($=>$.isVisible)},[$e,Oe,B]),He=t.useCallback(i=>{if(!i||i.length===0)return i;try{return Object.keys(B).length>0?(console.log("🎮 CLIENT: Using identities from state (current session):",B),console.log("🎮 CLIENT: Identity keys available:",Object.keys(B)),console.log("🎮 CLIENT: Identity details:",Object.keys(B).map(n=>({position:n,username:B[n].username,userId:B[n].userId,hasDetectionData:!!B[n].detectionData}))),mt(i,B)):(console.log("🎮 CLIENT: No player identities available for current session"),console.log("No identity data available, returning unenhanced people with default names"),i)}catch(n){return console.error("Error enhancing person detection:",n),i}},[B]),mt=t.useCallback((i,n)=>{const o={...n},f=new Set,p=i.map(C=>((C.userId&&n[C.userId]||C.username&&!C.username.startsWith("Player "))&&C.userId&&f.add(C.userId),C));return p.forEach((C,$)=>{if(!C.userId&&C.username.startsWith("Player ")){const U=Object.keys(o).find(O=>{const z=o[O];return z.userId&&!f.has(z.userId)});if(U){const O=o[U];p[$]={...C,username:O.username,userId:O.userId},f.add(O.userId),console.log(`Enhanced detection: assigned ${O.username} to detected person`)}else{const O=String(C.id);n[O]&&(console.log(`Found identity for position ${O}:`,n[O].username),p[$]={...C,username:n[O].username,userId:n[O].userId})}}}),p},[]),Be=t.useCallback(async()=>{if(!(!y.current||!s.current))try{const n=(await y.current.detect(s.current)).filter(p=>p.class==="person").map(p=>({bbox:p.bbox,score:p.score})),o=We(n),f=He(o);E(f)}catch{}},[We,He]);t.useEffect(()=>{async function i(){try{const n=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});s.current&&(s.current.srcObject=n)}catch(n){console.error("Camera Error:",n),alert("Could not access camera.")}}return i(),()=>{s.current&&s.current.srcObject&&s.current.srcObject.getTracks().forEach(n=>n.stop()),g.current&&clearInterval(g.current)}},[]),t.useEffect(()=>{if(h&&s.current){const i=()=>{g.current=setInterval(()=>{Be()},100)};s.current.readyState>=2?i():s.current.addEventListener("loadeddata",i)}return()=>{g.current&&clearInterval(g.current)}},[h,Be]),t.useEffect(()=>{(async()=>{if(!window.SelfieSegmentation){const n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/selfie_segmentation.js",n.async=!0,document.body.appendChild(n),await new Promise((o,f)=>{n.onload=o,n.onerror=f})}if(window.SelfieSegmentation)try{D.current=new window.SelfieSegmentation({locateFile:n=>`https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/${n}`}),D.current.setOptions({modelSelection:1,selfieMode:!1}),D.current.onResults(n=>{Y(n.segmentationMask)}),J(!0)}catch{alert("Failed to initialize MediaPipe SelfieSegmentation.")}else alert("MediaPipe SelfieSegmentation library failed to load.")})()},[]),t.useEffect(()=>{let i;const n=async()=>{R&&s.current&&D.current&&s.current.videoWidth>0&&s.current.videoHeight>0&&await D.current.send({image:s.current}),i=requestAnimationFrame(n)};return R&&n(),()=>cancelAnimationFrame(i)},[R]),t.useEffect(()=>{const i=()=>{if(c.current&&s.current){const o=c.current,p=s.current.getBoundingClientRect();o.width=p.width,o.height=p.height,o.style.width=`${p.width}px`,o.style.height=`${p.height}px`}};i(),window.ResizeObserver&&(l.current=new ResizeObserver(()=>{i()}),s.current&&l.current.observe(s.current));const n=()=>i();return window.addEventListener("resize",n),window.addEventListener("orientationchange",n),()=>{l.current&&l.current.disconnect(),window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n)}},[]),t.useEffect(()=>{if(c.current&&s.current&&s.current.videoWidth>0){const i=c.current,n=i.getContext("2d"),o=s.current,f=o.getBoundingClientRect(),p=o.videoWidth/o.videoHeight,C=f.width/f.height;let $=0,U=0,O=o.videoWidth,z=o.videoHeight,G=0,Z=0,q=i.width,le=i.height;if(C>p){const k=o.videoWidth/C;U=(o.videoHeight-k)/2,z=k}else{const k=o.videoHeight*C;$=(o.videoWidth-k)/2,O=k}if(n.clearRect(0,0,i.width,i.height),I){n.save();const k=document.createElement("canvas"),Q=k.getContext("2d");k.width=i.width,k.height=i.height,Q.drawImage(I,$,U,O,z,0,0,i.width,i.height),n.drawImage(o,$,U,O,z,G,Z,q,le),n.globalCompositeOperation="destination-in",n.drawImage(k,0,0),n.globalCompositeOperation="source-atop",n.fillStyle="rgba(0,255,0,0.4)",n.fillRect(0,0,i.width,i.height),n.restore(),w&&w.length>0&&w.forEach(F=>{const[X,ee,se,V]=F.bbox,K=i.width/O,ie=i.height/z,xe=(X-$)*K+se*K/2,fe=(ee-U)*ie-10;xe>=0&&xe<=i.width&&fe>=-30&&fe<=i.height&&(n.fillStyle="#00ff00",n.font="20px Arial",n.textAlign="center",n.fillText(F.username||`Player ${F.id}`,xe,fe))})}else w&&w.length>0&&w.forEach(k=>{const[Q,F,X,ee]=k.bbox,se=i.width/O,V=i.height/z,K=(Q-$)*se,ie=(F-U)*V,xe=X*se,fe=ee*V;if(K+xe>=0&&K<=i.width&&ie+fe>=0&&ie<=i.height){n.strokeStyle="#00ff00",n.lineWidth=3,n.strokeRect(K,ie,xe,fe),n.font="16px Arial";const te=k.username||`Player ${k.id}`,Le=n.measureText(te).width+10;n.fillStyle="#00ff00",n.fillRect(K,ie-25,Le,25),n.fillStyle="#000000",n.fillText(te,K+5,ie-8)}})}},[w,I]);const[Se,Ue]=t.useState(!1),[xt,Je]=t.useState(251.2),[ft,qe]=t.useState("none"),Te=251.2;t.useEffect(()=>{let i;return Se?(qe("stroke-dashoffset 2s linear"),i=setTimeout(()=>{Je(0)},10)):i=setTimeout(()=>{qe("none"),Je(Te)},200),()=>{clearTimeout(i)}},[Se,Te]);const Ge=i=>{H("hit"),re(n=>{let o=localStorage.getItem("playerClass"),f=o?o.toLowerCase():"pistol",p=10;return f==="archer"?p=70:f==="shotgun"&&(p=40),n+p})},ut=()=>{if(ne<=0||W||Se||b)return;navigator.vibrate&&navigator.vibrate(60),Ue(!0);let i=localStorage.getItem("playerClass"),n=1;i==="archer"?n=7:i==="shotgun"&&(n=4),setTimeout(()=>Ue(!1),n*1e3);let o=!1;if(I&&w.length>0&&s.current&&c.current){const f=s.current,p=c.current;f.getBoundingClientRect();const C=p.getBoundingClientRect(),$=C.left+C.width/2,U=C.top+C.height/2,O=f.videoWidth/f.videoHeight,z=C.width/C.height;let G=0,Z=0,q=f.videoWidth,le=f.videoHeight;if(z>O){const K=f.videoWidth/z;Z=(f.videoHeight-K)/2,le=K}else{const K=f.videoHeight*z;G=(f.videoWidth-K)/2,q=K}const k=($-C.left)/C.width,Q=(U-C.top)/C.height,F=G+k*q,X=Z+Q*le,ee=document.createElement("canvas");ee.width=f.videoWidth,ee.height=f.videoHeight;const se=ee.getContext("2d");se.drawImage(I,0,0,f.videoWidth,f.videoHeight);const V=se.getImageData(Math.floor(F),Math.floor(X),1,1).data;if(V[3]>128&&(V[0]>128||V[1]>128||V[2]>128)){let K=1/0,ie=null;w.forEach(xe=>{const[fe,te,Le,pt]=xe.bbox,yt=fe+Le/2,vt=te+pt/2,Xe=Math.sqrt(Math.pow(F-yt,2)+Math.pow(X-vt,2));Xe<K&&(K=Xe,ie=xe)}),ie&&(M(P),Ge(ie.id),o=!0)}}else if(w.length>0&&s.current){const f=s.current,p=f.getBoundingClientRect(),C=f.videoWidth/f.videoHeight,$=p.width/p.height;let U=0,O=0,z=f.videoWidth,G=f.videoHeight;if($>C){const k=f.videoWidth/$;O=(f.videoHeight-k)/2,G=k}else{const k=f.videoHeight*$;U=(f.videoWidth-k)/2,z=k}const Z=U+z/2,q=O+G/2,le=w.find(k=>{const[Q,F,X,ee]=k.bbox;return Z>=Q&&Z<=Q+X&&q>=F&&q<=F+ee});le&&(M(P),Ge(le.id),o=!0)}o?_&&_.readyState===1&&(console.log("Sending hit event to server"),_.send(JSON.stringify({type:"hit"}))):(M(oe),H("miss"),_&&_.readyState===1&&_.send(JSON.stringify({type:"miss"})))},ht=()=>{me(0),m(!1)},bt=()=>{r("/")};t.useEffect(()=>{if(T){const i=setTimeout(()=>H(!1),500);return()=>clearTimeout(i)}},[T]);const gt=i=>`${Math.floor(i/60)}:${(i%60).toString().padStart(2,"0")}`,[ke,Ye]=t.useState(null);return t.useEffect(()=>{if(!w||w.length===0)return;const i=w.filter(n=>n.username&&!n.username.startsWith("Player ")).map(n=>n.username);if(i.length>0){Ye(i[0]);const n=setTimeout(()=>{Ye(null)},3e3);return()=>clearTimeout(n)}},[w]),t.useEffect(()=>()=>{console.log("🎮 CLIENT: PlayerPage unmounting, clearing identity data")},[]),e.jsxs("div",{className:"relative h-screen w-screen overflow-hidden bg-black",children:[e.jsx("video",{ref:s,className:`h-full w-full object-cover ${W?"blur-sm":""}`,autoPlay:!0,playsInline:!0,muted:!0}),e.jsx("canvas",{ref:c,className:"absolute top-0 left-0 w-full h-full pointer-events-none",style:{zIndex:1}}),e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center z-30",children:e.jsxs("div",{className:"w-16 h-16 relative flex items-center justify-center",children:[e.jsx("div",{className:"absolute left-1/2 top-0 w-0.5 h-4 bg-red-500",style:{transform:"translateX(-50%)"}}),e.jsx("div",{className:"absolute left-1/2 bottom-0 w-0.5 h-4 bg-red-500",style:{transform:"translateX(-50%)"}}),e.jsx("div",{className:"absolute top-1/2 left-0 h-0.5 w-4 bg-red-500",style:{transform:"translateY(-50%)"}}),e.jsx("div",{className:"absolute top-1/2 right-0 h-0.5 w-4 bg-red-500",style:{transform:"translateY(-50%)"}}),e.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-red-500 bg-white/80"})]})}),b&&e.jsxs("div",{className:"absolute inset-0 z-50 flex flex-col items-center justify-center bg-black/70",children:[e.jsx("h2",{className:"text-5xl font-black text-white mb-4",children:"Game Starting"}),e.jsx("div",{className:"text-6xl font-extrabold text-emerald-400 animate-bounce-in",children:S>0?S:"GO!"})]}),T==="hit"&&e.jsx("div",{className:"pointer-events-none absolute inset-0 z-20 flex items-center justify-center",children:e.jsx("h2",{className:"animate-ping-once text-5xl font-black text-white drop-shadow-lg",children:"HIT"})}),T==="miss"&&e.jsx("div",{className:"pointer-events-none absolute inset-0 z-20 flex items-center justify-center",children:e.jsx("h2",{className:"animate-ping-once text-5xl font-black text-red-400 drop-shadow-lg",children:"MISS"})}),ne<=0&&e.jsx("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center bg-black/80 text-red-500",children:e.jsx("h1",{className:"text-6xl font-black",children:"ELIMINATED"})}),ke&&e.jsx("div",{className:"pointer-events-none absolute top-20 left-1/2 transform -translate-x-1/2 z-20 animate-fade-in",children:e.jsxs("div",{className:"bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center",children:[e.jsx("span",{className:"mr-2",children:"👤"}),e.jsx("span",{className:"font-bold",children:ke}),e.jsx("span",{className:"ml-2",children:"detected!"})]})}),ke&&e.jsx("div",{className:"pointer-events-none absolute bottom-32 left-0 right-0 z-20 flex items-center justify-center",children:e.jsx("div",{className:"animate-fade-in-out rounded-lg bg-black/70 px-6 py-3 text-center",children:e.jsxs("span",{className:"text-lg font-bold text-white",children:[ke," has entered the game!"]})})}),W&&e.jsx("div",{className:"absolute inset-0 z-30 flex flex-col items-center justify-center bg-black/70 p-4",children:e.jsxs("div",{className:"w-full max-w-sm space-y-4 rounded-lg bg-gray-900 p-6 shadow-2xl",children:[e.jsx("h2",{className:"text-center text-2xl font-bold",children:"Game Menu"}),e.jsx(ce,{onClick:()=>m(!1),children:"Resume Game"}),e.jsxs(ce,{onClick:ht,className:"flex items-center justify-center gap-2 bg-yellow-700 hover:bg-yellow-600",children:[e.jsx(Zt,{size:20}),e.jsx("span",{children:"Commit Suicide"})]}),e.jsxs(ce,{onClick:bt,className:"flex items-center justify-center gap-2 bg-red-800 hover:bg-red-700",children:[e.jsx(ot,{size:20}),e.jsx("span",{children:"Quit to Main Menu"})]})]})}),e.jsxs("div",{className:"absolute inset-0 z-10 flex flex-col justify-between p-4 text-white",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-black/50 p-2 backdrop-blur-sm",children:[e.jsx(es,{size:20}),e.jsx("span",{className:"text-xl font-bold",children:gt(L)})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex flex-col items-end rounded-lg bg-black/50 p-2 text-right backdrop-blur-sm",children:[e.jsx("span",{className:"text-xs font-bold uppercase",children:"Score"}),e.jsx("span",{className:"text-2xl font-black",children:ae})]})}),e.jsx("button",{onClick:()=>m(!0),className:"rounded-lg bg-black/50 p-2 backdrop-blur-sm",children:e.jsx(Gt,{size:24})})]}),e.jsx("div",{className:"flex flex-col items-center gap-3",children:e.jsx("button",{onClick:ut,disabled:ne<=0||W||b||Se,className:`
              flex h-24 w-24 items-center justify-center rounded-full border-4 border-white/50
              text-white transition-transform active:scale-90 disabled:cursor-not-allowed
              relative
              ${Se?"bg-gray-700/80":"bg-red-600/80"}
            `,children:Se?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"absolute top-0 left-0 h-full w-full",viewBox:"0 0 100 100",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{className:"stroke-current text-white/20",strokeWidth:"8",cx:"50",cy:"50",r:"40",fill:"transparent"}),e.jsx("circle",{className:"stroke-current text-red-500",strokeWidth:"8",strokeDasharray:Te,strokeDashoffset:xt,strokeLinecap:"round",cx:"50",cy:"50",r:"40",fill:"transparent",style:{transition:ft}})]}),e.jsx("div",{className:"relative z-10 flex h-full w-full items-center justify-center",children:e.jsx("span",{className:"text-lg font-bold animate-pulse",children:"RELOADING..."})})]}):e.jsx(Fe,{size:48})})})]})]})},ms=()=>{const{gameId:a}=Me(),r=ye(),[s,c]=t.useState(null),[l,y]=t.useState([]),{ws:g}=he();t.useEffect(()=>{if(!g)return;const h=x=>{try{const w=JSON.parse(x.data);if(w.type==="lobby_status"&&w.players){const E=[...w.players].sort((D,R)=>R.score-D.score);y(E),E.length>0&&c(E[0])}}catch{}};return g.addEventListener("message",h),g.send(JSON.stringify({type:"get_lobby_status",gameId:a})),()=>g.removeEventListener("message",h)},[g,a]);const d=h=>{switch(h){case 0:return e.jsx(ve,{size:24,className:"text-yellow-400"});case 1:return e.jsx(tt,{size:22,className:"text-gray-300"});case 2:return e.jsx(qt,{size:22,className:"text-amber-600"});default:return e.jsx(Ht,{size:20,className:"text-[#9351f7]"})}},j=h=>{switch(h){case 0:return"bg-gradient-to-r from-yellow-500/30 to-amber-400/30 border-yellow-400/50 shadow-yellow-400/20";case 1:return"bg-gradient-to-r from-gray-400/30 to-gray-300/30 border-gray-300/50 shadow-gray-300/20";case 2:return"bg-gradient-to-r from-amber-600/30 to-amber-500/30 border-amber-500/50 shadow-amber-500/20";default:return"bg-gradient-to-r from-[#741ff5]/30 to-[#9351f7]/30 border-[#9351f7]/50 shadow-[#9351f7]/20"}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0f051d] via-[#1f152b] to-[#0f051d] relative overflow-hidden",children:[e.jsx(pe,{}),e.jsxs("header",{className:"flex justify-between items-center py-4 md:py-6 relative z-10 px-4 md:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>r("/"),className:"text-white hover:text-[#e971ff] transition-colors p-2 rounded-full hover:bg-white/10",children:e.jsx(Ne,{size:24})}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:"HBlast"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-[#b7b4bb] text-sm md:text-base",children:"Battle Complete"}),e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10",children:e.jsx("img",{src:"/images/icon.png",alt:"HBlast Score Icon",className:"w-full h-full object-contain"})})]})]}),e.jsx("main",{className:"flex-grow p-4 md:p-6 relative z-10",children:e.jsxs("div",{className:"mx-auto w-full max-w-4xl space-y-6 md:space-y-8",children:[s&&e.jsx("div",{className:"text-center mb-8 md:mb-12",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-3xl p-6 md:p-8 border-2 border-yellow-400/40 shadow-2xl shadow-yellow-400/20 max-w-md mx-auto",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 mx-auto bg-gradient-to-r from-yellow-400 to-amber-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(ve,{size:40,className:"text-black"})}),e.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-[#e971ff] rounded-full flex items-center justify-center",children:e.jsx(ge,{size:16,className:"text-white"})})]}),e.jsx("h2",{className:"text-lg md:text-xl font-bold text-yellow-400 mb-2",children:"🏆 CHAMPION 🏆"}),e.jsx("p",{className:"text-3xl md:text-4xl lg:text-5xl font-black text-transparent bg-gradient-to-r from-yellow-400 via-amber-400 to-yellow-500 bg-clip-text mb-2",children:s.name}),e.jsxs("div",{className:"text-2xl md:text-3xl font-bold text-[#e971ff]",children:[s.score?.toLocaleString()," points"]}),e.jsx("div",{className:"mt-4 text-sm text-[#b7b4bb]",children:"Dominated the battlefield!"})]})}),e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-4 md:p-6 border border-[#2a3441]/30 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 md:mb-8",children:[e.jsx(tt,{size:24,className:"text-[#e971ff]"}),e.jsx("h3",{className:"text-white text-xl md:text-2xl font-bold",children:"Final Standings"}),e.jsx("div",{className:"w-2 h-2 bg-[#e971ff] rounded-full animate-pulse ml-auto"})]}),e.jsx("div",{className:"space-y-3 md:space-y-4",children:l.map((h,x)=>e.jsxs("div",{className:`
                    relative p-4 md:p-6 rounded-xl border-2 transition-all duration-500 hover:shadow-2xl transform hover:scale-[1.02]
                    ${j(x)}
                  `,children:[e.jsx("div",{className:"absolute -top-2 -left-2 w-8 h-8 md:w-10 md:h-10 rounded-full bg-gradient-to-r from-[#741ff5] to-[#9351f7] flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-sm md:text-base font-bold",children:x+1})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 md:gap-6 min-w-0 flex-1",children:[d(x),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-white font-bold text-lg md:text-xl truncate",children:h.name}),x===0&&e.jsx("div",{className:"text-yellow-400 text-sm font-medium",children:"🏆 Champion"}),x===1&&e.jsx("div",{className:"text-gray-300 text-sm font-medium",children:"🥈 Runner-up"}),x===2&&e.jsx("div",{className:"text-amber-600 text-sm font-medium",children:"🥉 Third Place"})]})]}),e.jsxs("div",{className:"text-right ml-2 md:ml-4 flex-shrink-0",children:[e.jsx("div",{className:"text-white text-xl md:text-3xl font-bold",children:h.score?.toLocaleString()||0}),e.jsx("div",{className:"text-[#b7b4bb] text-xs md:text-sm",children:"points"})]})]}),x<3&&l.length>0&&e.jsx("div",{className:"mt-3 md:mt-4 bg-black/30 rounded-full h-1.5 md:h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${x===0?"bg-gradient-to-r from-yellow-500 to-amber-400":x===1?"bg-gradient-to-r from-gray-400 to-gray-300":"bg-gradient-to-r from-amber-600 to-amber-500"}`,style:{width:`${Math.min(h.score/l[0].score*100,100)}%`}})})]},h.id))}),l.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-[#b7b4bb] text-lg mb-2",children:"No battle data available"}),e.jsx("div",{className:"text-[#b7b4bb] text-sm",children:"Results will appear here after the game"})]})]}),e.jsxs("div",{className:"space-y-3 md:space-y-4 max-w-md mx-auto",children:[e.jsx(ce,{onClick:()=>r("/spectate"),className:"w-full bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-cyan-600 hover:to-teal-500 text-white shadow-lg hover:shadow-xl transform hover:scale-105 py-3 md:py-4 rounded-2xl",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{className:"font-semibold",children:"Spectate Other Battles"})]})}),e.jsx(ce,{onClick:()=>r("/"),className:"w-full bg-gradient-to-r from-[#7b7583] to-[#838383] hover:from-[#838383] hover:to-[#7b7583] text-white shadow-lg hover:shadow-xl transform hover:scale-105 py-3 md:py-4 rounded-2xl",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(nt,{size:20}),e.jsx("span",{className:"font-semibold",children:"Return to Home"})]})})]}),l.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-[#1f152b] to-[#0f051d] rounded-2xl p-4 md:p-6 border border-[#2a3441]/30 shadow-xl max-w-md mx-auto",children:[e.jsxs("h4",{className:"text-white text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(ue,{size:20,className:"text-[#e971ff]"}),"Battle Summary"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-[#e971ff]",children:l.length}),e.jsx("div",{className:"text-xs text-[#b7b4bb]",children:"Warriors"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-[#e971ff]",children:Math.max(...l.map(h=>h.score||0)).toLocaleString()}),e.jsx("div",{className:"text-xs text-[#b7b4bb]",children:"Top Score"})]})]})]})]})})]})},xs=()=>{const{lobbyId:a}=Me(),{ws:r}=he(),[s,c]=t.useState([]),[l,y]=t.useState(null),[g,d]=t.useState([]),[j,h]=t.useState(null),[x,w]=t.useState("waiting"),E=t.useRef({}),D=ye();t.useEffect(()=>{if(!r)return;const v=T=>{try{const H=JSON.parse(T.data);if(H.type==="lobby_status"&&Array.isArray(H.players)){const W=H.players.map(b=>({id:b.id||b.userId,name:b.name||b.username||`Player ${(b.id||b.userId)?.substring(0,4)}`,score:b.score||0,role:b.role,ready:b.ready||!1,class:b.class||"pistol"})),m=W.sort((b,N)=>N.score-b.score);if(W.forEach(b=>{const N=E.current[b.id]||0;if(b.score>N){const S=b.score-N,u=J(b.class),P=Y(S,b.class);d(oe=>[{id:Date.now()+Math.random(),type:"hit",player:b.name,weapon:u,points:S,hits:P,timestamp:new Date().toLocaleTimeString(),icon:I(b.class)},...oe.slice(0,9)])}E.current[b.id]=b.score}),c(m),m.length>0){const b=m[0];(!l||l.id!==b.id)&&y(b)}}H.type==="game_start"&&(w("active"),d(W=>[{id:Date.now(),type:"game_event",message:"Game Started!",timestamp:new Date().toLocaleTimeString(),icon:e.jsx(ge,{size:16,className:"text-green-400"})},...W.slice(0,9)])),H.type==="game_end"&&(w("ended"),d(W=>[{id:Date.now(),type:"game_event",message:"Game Ended!",timestamp:new Date().toLocaleTimeString(),icon:e.jsx(ve,{size:16,className:"text-yellow-400"})},...W.slice(0,9)])),H.type==="lobby_members"&&H.code===a&&h({code:H.code,members:H.members,host:H.members.find(W=>W.isHost)?.username||"Unknown"})}catch{}};return r.addEventListener("message",v),r.send(JSON.stringify({type:"get_lobby_status",gameId:a})),()=>r.removeEventListener("message",v)},[r,a,l]);const R=v=>{y(v)},J=v=>{switch(v){case"pistol":return"Pistol";case"shotgun":return"Shotgun";case"archer":return"Bow";default:return"Unknown"}},I=v=>{switch(v){case"pistol":return e.jsx(ue,{size:16,className:"text-blue-400"});case"shotgun":return e.jsx(lt,{size:16,className:"text-red-400"});case"archer":return e.jsx(Fe,{size:16,className:"text-green-400"});default:return e.jsx(ue,{size:16,className:"text-gray-400"})}},Y=(v,T)=>{switch(T){case"pistol":return Math.floor(v/10);case"shotgun":return Math.floor(v/40);case"archer":return Math.floor(v/70);default:return Math.floor(v/10)}},ne=v=>{switch(v){case"pistol":return"text-blue-400";case"shotgun":return"text-red-400";case"archer":return"text-green-400";default:return"text-gray-400"}},me=()=>s.map(v=>{const T=Math.floor(v.score/ae(v.class)),H=T>0?Math.floor(T*(Math.random()*.5+1.2)):0,W=H>0?Math.floor(T/H*100):0;return{...v,hits:T,accuracy:Math.min(W,100),weapon:J(v.class)}}),ae=v=>{switch(v){case"pistol":return 10;case"shotgun":return 40;case"archer":return 70;default:return 10}},re=()=>{switch(x){case"active":return"text-green-400";case"ended":return"text-red-400";default:return"text-yellow-400"}},L=()=>{switch(x){case"active":return"Live Match";case"ended":return"Match Ended";default:return"Waiting to Start"}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0f051d] via-[#1f152b] to-[#0f051d] relative overflow-hidden",children:[e.jsx(pe,{}),e.jsxs("header",{className:"flex justify-between items-center py-4 md:py-6 relative z-10 px-4 md:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>D("/"),className:"text-white hover:text-[#e971ff] transition-colors p-2 rounded-full hover:bg-white/10",children:e.jsx(Ne,{size:24})}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:"HBlast"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`text-sm md:text-base ${re()}`,children:L()}),e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10",children:e.jsx("img",{src:"/images/icon.png",alt:"HBlast Score Icon",className:"w-full h-full object-contain"})})]})]}),e.jsxs("div",{className:"px-4 md:px-6 lg:px-8 pb-6 relative z-10",children:[e.jsxs("div",{className:"text-center mb-6 md:mb-8",children:[e.jsxs("h1",{className:"text-white text-3xl md:text-4xl font-bold mb-2",children:[e.jsx("span",{className:"block",children:"Spectating"}),e.jsxs("span",{className:"block text-[#e971ff]",children:["Game ",a]})]}),e.jsx("p",{className:"text-[#b7b4bb] text-base md:text-lg",children:"Watch the battle unfold in real-time"})]}),l&&e.jsx("div",{className:"max-w-4xl mx-auto mb-8",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-4 md:p-6 border-2 border-[#9351f7]/40 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),e.jsx("h2",{className:"text-white text-xl md:text-2xl font-bold",children:"Live Feed"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[#e971ff]",children:[e.jsx(Pe,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Leading Player"})]})]}),e.jsxs("div",{className:"aspect-video bg-gradient-to-br from-[#0f051d] to-[#1f152b] rounded-xl mb-4 flex items-center justify-center border-2 border-[#2a3441]/30 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-900/20 via-purple-900/20 to-pink-900/20"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"w-12 h-12 relative",children:[e.jsx("div",{className:"absolute left-1/2 top-0 w-0.5 h-3 bg-red-500",style:{transform:"translateX(-50%)"}}),e.jsx("div",{className:"absolute left-1/2 bottom-0 w-0.5 h-3 bg-red-500",style:{transform:"translateX(-50%)"}}),e.jsx("div",{className:"absolute top-1/2 left-0 h-0.5 w-3 bg-red-500",style:{transform:"translateY(-50%)"}}),e.jsx("div",{className:"absolute top-1/2 right-0 h-0.5 w-3 bg-red-500",style:{transform:"translateY(-50%)"}}),e.jsx("div",{className:"w-2 h-2 rounded-full border border-red-500 bg-red-500/30 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})]})}),e.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2 bg-black/50 rounded-lg px-3 py-1",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-white text-sm font-bold",children:"LIVE"})]}),e.jsx("div",{className:"absolute bottom-4 left-4 right-4",children:e.jsx("div",{className:"bg-black/70 rounded-lg p-3 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{size:20,className:"text-yellow-400"}),e.jsx("span",{className:"text-white font-bold text-lg",children:l.name})]}),e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 bg-[#9351f7]/30 rounded-full",children:[I(l.class),e.jsx("span",{className:`text-sm font-medium ${ne(l.class)}`,children:J(l.class)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[#e971ff] text-2xl font-bold",children:l.score}),e.jsx("div",{className:"text-[#b7b4bb] text-xs",children:"points"})]})]})})})]}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-[#b7b4bb] text-sm",children:[e.jsx(ts,{size:16,className:"text-green-400"}),e.jsxs("span",{children:["Connected to ",l.name,"'s feed"]})]})})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-3 mb-6",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-xl p-4 border border-[#2a3441]/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(we,{size:20,className:"text-[#e971ff]"}),e.jsx("span",{className:"text-[#b7b4bb] text-sm",children:"Players"})]}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:s.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-xl p-4 border border-[#2a3441]/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ue,{size:20,className:"text-[#e971ff]"}),e.jsx("span",{className:"text-[#b7b4bb] text-sm",children:"Total Hits"})]}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:s.reduce((v,T)=>v+Math.floor(T.score/ae(T.class)),0)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-xl p-4 border border-[#2a3441]/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Wt,{size:20,className:"text-[#e971ff]"}),e.jsx("span",{className:"text-[#b7b4bb] text-sm",children:"Top Score"})]}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:s.length>0?Math.max(...s.map(v=>v.score)):0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-xl p-4 border border-[#2a3441]/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{size:20,className:"text-[#e971ff]"}),e.jsx("span",{className:"text-[#b7b4bb] text-sm",children:"Live Actions"})]}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:g.length})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-4 md:p-6 border border-[#2a3441]/30 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ve,{size:24,className:"text-[#e971ff]"}),e.jsx("h3",{className:"text-white text-xl md:text-2xl font-bold",children:"Live Leaderboard"}),e.jsx("div",{className:"w-2 h-2 bg-[#e971ff] rounded-full animate-pulse ml-auto"})]}),e.jsx("div",{className:"space-y-3",children:me().map((v,T)=>{const H=l&&l.id===v.id;return e.jsxs("div",{onClick:()=>R(v),className:`
                        relative p-4 rounded-xl border-2 transition-all duration-300 cursor-pointer hover:scale-[1.02]
                        ${H?"bg-gradient-to-r from-[#e971ff]/20 to-[#9351f7]/20 border-[#e971ff]/50 shadow-lg shadow-[#e971ff]/20":T===0?"bg-gradient-to-r from-yellow-500/20 to-amber-400/20 border-yellow-400/50":"bg-gradient-to-r from-[#741ff5]/10 to-[#9351f7]/10 border-[#9351f7]/30 hover:border-[#e971ff]/50"}
                      `,children:[e.jsx("div",{className:"absolute -top-2 -left-2 w-8 h-8 rounded-full bg-gradient-to-r from-[#741ff5] to-[#9351f7] flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-sm font-bold",children:T+1})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[T===0?e.jsx(ve,{size:20,className:"text-yellow-400"}):I(v.class),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-white font-bold text-lg truncate",children:v.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:`${ne(v.class)} font-medium`,children:v.weapon}),e.jsx("span",{className:"text-[#b7b4bb]",children:"•"}),e.jsxs("span",{className:"text-[#b7b4bb]",children:[v.hits," hits"]})]})]})]}),e.jsxs("div",{className:"text-right ml-4 flex-shrink-0",children:[e.jsx("div",{className:"text-white text-xl font-bold",children:v.score?.toLocaleString()||0}),e.jsx("div",{className:"text-[#b7b4bb] text-xs",children:"points"})]})]}),H&&e.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1 bg-[#e971ff]/80 px-2 py-1 rounded-full",children:[e.jsx(Pe,{size:12,className:"text-white"}),e.jsx("span",{className:"text-white text-xs font-bold",children:"LIVE"})]})]},v.id)})}),s.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-[#b7b4bb] text-lg mb-2",children:"No players in battle"}),e.jsx("div",{className:"text-[#b7b4bb] text-sm",children:"Waiting for warriors to join..."})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-4 md:p-6 border border-[#2a3441]/30 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ge,{size:24,className:"text-[#e971ff]"}),e.jsx("h3",{className:"text-white text-lg md:text-xl font-bold",children:"Live Feed"}),e.jsx("div",{className:"w-2 h-2 bg-[#e971ff] rounded-full animate-pulse ml-auto"})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:g.length>0?g.map(v=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gradient-to-r from-[#741ff5]/20 to-transparent rounded-lg border border-[#9351f7]/20",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:v.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[v.type==="hit"?e.jsxs("div",{children:[e.jsxs("div",{className:"text-white text-sm font-medium",children:[e.jsx("span",{className:"text-[#e971ff]",children:v.player})," scored with ",v.weapon]}),e.jsxs("div",{className:"text-[#b7b4bb] text-xs",children:["+",v.points," points (",v.hits," hits)"]})]}):e.jsx("div",{className:"text-white text-sm",children:v.message}),e.jsx("div",{className:"text-[#b7b4bb] text-xs mt-1",children:v.timestamp})]})]},v.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-[#b7b4bb] text-sm",children:"No recent activity"}),e.jsx("div",{className:"text-[#b7b4bb] text-xs mt-1",children:"Actions will appear during gameplay"})]})})]})})]})]})]})},fs=()=>{const[a,r]=t.useState([]),s=ye(),{sendMessage:c,lastMessage:l,wsStatus:y,ws:g}=he();t.useEffect(()=>{y==="open"&&c({type:"show_lobbies"})},[y,c]),t.useEffect(()=>{if(l)try{const h=JSON.parse(l);console.log(h),h.type==="lobby_list"&&Array.isArray(h.lobbies)&&r(h.lobbies.map(x=>({id:x.code,name:x.name||"Unnamed Lobby",players:x.playerCount,maxPlayers:x.maxPlayers||8,status:x.playerCount>=(x.maxPlayers||8)?"Full":"Waiting"})))}catch{}},[l]);const d=h=>{switch(h){case"In Progress":return"text-[#e971ff] bg-[#e971ff]/20";case"Waiting":return"text-yellow-400 bg-yellow-400/20";case"Full":return"text-red-400 bg-red-400/20";default:return"text-[#b7b4bb] bg-[#b7b4bb]/20"}},j=h=>{switch(h){case"In Progress":return e.jsx(ge,{size:14});case"Waiting":return e.jsx(rt,{size:14});case"Full":return e.jsx(we,{size:14});default:return e.jsx(Kt,{size:14})}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0f051d] via-[#1f152b] to-[#0f051d] relative overflow-hidden",children:[e.jsx(pe,{}),e.jsxs("header",{className:"flex justify-between items-center py-4 md:py-6 relative z-10 px-4 md:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s("/"),className:"text-white hover:text-[#e971ff] transition-colors p-2 rounded-full hover:bg-white/10",children:e.jsx(Ne,{size:24})}),e.jsx("div",{className:"text-white text-xl md:text-2xl font-bold",children:"HBlast"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-[#b7b4bb] text-sm md:text-base",children:"Spectate"}),e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10",children:e.jsx("img",{src:"/images/icon.png",alt:"HBlast Score Icon",className:"w-full h-full object-contain"})})]})]}),e.jsxs("div",{className:"px-4 md:px-6 lg:px-8 pb-6 relative z-10",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsxs("h1",{className:"text-white text-3xl md:text-4xl lg:text-5xl font-bold mb-4",children:[e.jsx("span",{className:"block",children:"Choose Your"}),e.jsx("span",{className:"block",children:"Battle to Watch"})]}),e.jsx("p",{className:"text-[#b7b4bb] text-base md:text-lg max-w-md mx-auto",children:"Jump into live matches and watch the action unfold in real-time"})]}),e.jsx("div",{className:"max-w-4xl mx-auto mb-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-[#1f152b] to-[#0f051d] rounded-xl p-3 md:p-4 border border-[#2a3441]/30 flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${y==="open"?"bg-green-400 animate-pulse":"bg-red-400"}`}),e.jsx("span",{className:"text-white text-sm md:text-base font-medium",children:y==="open"?"Connected to Game Network":"Connecting to Game Network..."}),e.jsx("div",{className:"ml-auto text-[#b7b4bb] text-xs md:text-sm",children:y==="open"?`${a.length} active lobbies`:"Searching..."})]})}),e.jsx("main",{className:"max-w-6xl mx-auto",children:a.length>0?e.jsx("div",{className:"grid gap-4 md:gap-6",children:a.map(h=>e.jsx("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-4 md:p-6 border-2 border-[#9351f7]/40 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-[1.02] hover:border-[#e971ff]/60 hover:shadow-[#9351f7]/20",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-white text-xl md:text-2xl font-bold",children:h.name}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${d(h.status)}`,children:[j(h.status),e.jsx("span",{children:h.status})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 md:gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#b7b4bb]",children:[e.jsx(we,{size:16,className:"text-[#e971ff]"}),e.jsxs("span",{className:"text-sm md:text-base",children:[h.players," player(s)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[#b7b4bb]",children:[e.jsx(ue,{size:16,className:"text-[#e971ff]"}),e.jsxs("span",{className:"text-sm md:text-base",children:["Lobby ",h.id]})]}),h.status==="In Progress"&&e.jsxs("div",{className:"flex items-center gap-2 text-green-400",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm md:text-base",children:"Live"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"bg-black/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#741ff5] to-[#9351f7] transition-all duration-500",style:{width:`${h.players/h.maxPlayers*100}%`}})})})]}),e.jsx("div",{className:"lg:ml-6",children:e.jsxs("button",{onClick:()=>s(`/spectate/${h.id}`),className:`
                          flex items-center gap-2 px-6 md:px-8 py-3 md:py-4 rounded-full font-semibold text-sm md:text-base transition-all duration-200 w-full lg:w-auto justify-center
                          bg-gradient-to-r from-[#741ff5] to-[#9351f7] hover:from-[#9351f7] hover:to-[#e971ff] text-white shadow-lg hover:shadow-xl transform hover:scale-105"
                         `,children:[e.jsx(Pe,{size:18}),e.jsx("span",{children:"Spectate Match"})]})})]})},h.id))}):e.jsx("div",{className:"text-center py-12 md:py-16",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1f152b] to-[#0f051d] rounded-2xl p-8 md:p-12 border border-[#2a3441]/30 max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-[#741ff5] to-[#9351f7] rounded-full flex items-center justify-center",children:e.jsx(ue,{size:32,className:"text-white"})}),e.jsx("div",{className:"w-2 h-2 bg-[#e971ff] rounded-full animate-pulse mx-auto mb-4"})]}),e.jsx("h3",{className:"text-white text-xl md:text-2xl font-bold mb-2",children:y==="open"?"No Active Matches":"Connecting..."}),e.jsx("p",{className:"text-[#b7b4bb] mb-6",children:y==="open"?"All players are taking a break. Check back soon for live action!":"Searching for active game lobbies..."}),e.jsx("button",{onClick:()=>{y==="open"&&c({type:"show_lobbies"}),window.location.reload()},disabled:y!=="open",className:`
                    px-6 py-3 rounded-full font-semibold transition-all duration-200
                    ${y==="open"?"bg-gradient-to-r from-[#741ff5] to-[#9351f7] hover:from-[#9351f7] hover:to-[#e971ff] text-white hover:scale-105":"bg-gradient-to-r from-[#7b7583] to-[#838383] text-white/70 cursor-not-allowed"}
                  `,children:y==="open"?"Refresh Lobbies":"Connecting..."})]})})})]})]})};function us(){return t.useEffect(()=>{const a=()=>{if(typeof window<"u")try{const s=window.AudioContext||window.webkitAudioContext,c=new s,l=c.createOscillator();l.frequency.setValueAtTime(.001,c.currentTime),l.connect(c.destination),l.start(),l.stop(c.currentTime+.001)}catch(s){console.error("Audio initialization failed:",s)}},r=()=>{window.removeEventListener("touchstart",r),window.removeEventListener("mousedown",r),a()};return window.addEventListener("touchstart",r,{once:!0}),window.addEventListener("mousedown",r,{once:!0}),()=>{window.removeEventListener("touchstart",r),window.removeEventListener("mousedown",r)}},[]),e.jsx(At,{children:e.jsx(St,{children:e.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:e.jsxs(It,{children:[e.jsx(be,{path:"/",element:e.jsx(Tt,{})}),e.jsx(be,{path:"/lobby",element:e.jsx(ss,{})}),e.jsx(be,{path:"/lobby/create",element:e.jsx(ns,{})}),e.jsx(be,{path:"/lobby/join",element:e.jsx(os,{})}),e.jsx(be,{path:"/lobby/:lobbyId/waitlist",element:e.jsx(cs,{})}),e.jsx(be,{path:"/game/:gameId",element:e.jsx(ds,{})}),e.jsx(be,{path:"/game/:gameId/end",element:e.jsx(ms,{})}),e.jsx(be,{path:"/spectate",element:e.jsx(fs,{})}),e.jsx(be,{path:"/spectate/:lobbyId",element:e.jsx(xs,{})})]})})})})}Rt.createRoot(document.getElementById("root")).render(e.jsx(_e.StrictMode,{children:e.jsx(us,{})}));
